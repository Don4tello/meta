#!/usr/bin/env python3
# @lint-ignore-every DSFMT [do not copy-paste]. Format the file to remove this comment. https://fburl.com/wiki/mmzh332m


from dataswarm.operators import (
    GlobalDefaults,
    WaitForHiveOperator,
    PrestoOperator,
    TableauPublishOperator,
)
from dataswarm.operators.runcontext import is_test
from dataswarm_commons.operators import PrestoInsertOperatorWithSchema
from dataswarm_commons.operators.schema import Column, HiveAnon, Table


GlobalDefaults.set(
    user="seannolan",
    schedule="@daily",
    num_retries=1,
    depends_on_past=False,
    macros={
        "QUARTERID": "CAST(DATE_TRUNC('quarter',DATE('<DATEID>')) AS VARCHAR)",
    },
    data_project_acl="gms_tech_data_eng",
    oncall="bp_t_gms_tech_de_bp_o",
    partition="ds=<DATEID>",
    extra_emails=[],
)

wait_for_bpo_quota_and_forecast_fast = WaitForHiveOperator(
    dep_list=[],
    table="bpo_gms_quota_and_forecast_fast",
    use_future=False,
    fail_on_future=True,
)

bpo_gms_quota_and_forecast_rtm_advertiser = PrestoInsertOperatorWithSchema(
    dep_list=[wait_for_bpo_quota_and_forecast_fast],
    table="<TABLE:bpo_gms_quota_and_forecast_rtm_fast>",
    partition="ds=<DATEID>/route_to_market=Advertiser",
    documentation={
        "description": """Creates a Subpartition for Advertiser on Route to Market"""
    },
    create=Table(
        cols=[
            Column('ultimate_client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('ultimate_client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('program', 'VARCHAR','', HiveAnon.NONE),
            Column('vertical', 'VARCHAR','', HiveAnon.NONE),
            Column('segmentation', 'VARCHAR','', HiveAnon.NONE),
            Column('asofdate', 'VARCHAR','', HiveAnon.NONE),
            Column('quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('next_quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('days_left_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_left_in_quarter_prior', 'BIGINT','', HiveAnon.NONE),
            Column('days_total_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_closed_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('l12_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l4_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l2_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_subregion', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_region', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_market', 'VARCHAR','', HiveAnon.NONE),
            Column('country', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('run_rate_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('quota', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('employee_type_1', 'VARCHAR','', HiveAnon.NONE),
            Column('employee_type_2', 'VARCHAR','', HiveAnon.NONE),
            Column('l12_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('revenue_segment', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_product_resilient_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_ebr_usd_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_capi_ebr_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
        ],
        partitions=[
            Column('ds', 'VARCHAR', 'datestamp'),
            Column('route_to_market', 'VARCHAR', ''),
        ],
        retention=15,
    ),
    select=r"""
        Select
        ultimate_parent_fbid ultimate_client_fbid ,
        ultimate_parent_name ultimate_client_name ,
        advertiser_name client_name ,
        advertiser_fbid client_fbid ,
        program ,
        advertiser_vertical vertical ,
        segmentation ,
        asofdate ,
        quarter_id ,
        next_quarter_id ,
        days_left_in_quarter ,
        days_left_in_quarter_prior ,
        days_total_in_quarter ,
        days_closed_in_quarter ,
        l12_reporting_territory l12_territory ,
        l10_reporting_territory l10_territory ,
        l8_reporting_territory l8_territory  ,
        l6_reporting_territory l6_territory  ,
        l4_reporting_territory l4_territory  ,
        l2_reporting_territory l2_territory  ,
        sales_adv_subregion fb_subregion ,
        sales_adv_region fb_region ,
        market fb_market ,
        advertiser_country country ,
        cp_username employee_type_1,
        am_username employee_type_2,
        l12_reporting_terr_mgr l12_territory_mgr,
        l10_reporting_terr_mgr l10_territory_mgr,
        l8_reporting_terr_mgr l8_territory_mgr,
        l6_reporting_terr_mgr l6_territory_mgr,
        SUM(run_rate_forecast) run_rate_forecast,
        SUM(run_rate_forecast_prior) run_rate_forecast_prior,
        SUM(advertiser_quota) quota,
        SUM(sales_forecast) sales_forecast,
        SUM(sales_forecast_prior) sales_forecast_prior,
        SUM(cq_revenue) cq_revenue,
        SUM(pq_revenue) pq_revenue,
        SUM(cq_revenue_qtd_prior) cq_revenue_qtd_prior,
        SUM(lyq_revenue) lyq_revenue,
        SUM(l2yq_revenue) l2yq_revenue,
        SUM(lyq_revenue_qtd) lyq_revenue_qtd,
        SUM(l2yq_revenue_qtd) l2yq_revenue_qtd,
        SUM(lyq_revenue_qtd_prior) lyq_revenue_qtd_prior,
        SUM(l2yq_revenue_qtd_prior) l2yq_revenue_qtd_prior,
        SUM(pq_revenue_qtd) pq_revenue_qtd,
        SUM(l7d_revenue) l7d_revenue,
        SUM(l7d_revenue_prior) l7d_revenue_prior,
        SUM(l7d_avg_revenue) l7d_avg_revenue,
        SUM(l7d_avg_revenue_prior) l7d_avg_revenue_prior,
        SUM(l7d_avg_ly_revenue) l7d_avg_ly_revenue,
        SUM(l7d_avg_ly_revenue_prior) l7d_avg_ly_revenue_prior,
        SUM(l7d_ly_revenue) l7d_ly_revenue,
        SUM(l7d_ly_revenue_prior) l7d_ly_revenue_prior,
        SUM(run_rate_forecast_2w_prior) run_rate_forecast_2w_prior,
        SUM(cq_revenue_qtd_2w_prior) cq_revenue_qtd_2w_prior,
        SUM(lyq_revenue_qtd_2w_prior) lyq_revenue_qtd_2w_prior,
        SUM(l2yq_revenue_qtd_2w_prior) l2yq_revenue_qtd_2w_prior,
        SUM(l14d_avg_revenue_prior) l14d_avg_revenue_prior,
        SUM(cq_optimal_qtd_2w_prior) cq_optimal_qtd_2w_prior,
        SUM(lyq_optimal_qtd_2w_prior) lyq_optimal_qtd_2w_prior,
        SUM(l14d_optimal_prior) l14d_optimal_prior,
        SUM(l14d_avg_optimal_prior) l14d_avg_optimal_prior,
        SUM(l14d_avg_ly_optimal_prior) l14d_avg_ly_optimal_prior,
        SUM(l14d_ly_optimal_prior) l14d_ly_optimal_prior,
        SUM(cq_dr_resilient_qtd_2w_prior) cq_dr_resilient_qtd_2w_prior,
        SUM(lyq_dr_resilient_qtd_2w_prior) lyq_dr_resilient_qtd_2w_prior,
        SUM(l14d_dr_resilient_prior) l14d_dr_resilient_prior,
        SUM(l14d_avg_dr_resilient_prior) l14d_avg_dr_resilient_prior,
        SUM(l14d_avg_ly_dr_resilient_prior) l14d_avg_ly_dr_resilient_prior,
        SUM(l14d_ly_dr_resilient_prior) l14d_ly_dr_resilient_prior,
        SUM(cq_product_resilient_rec_rev_qtd_2w_prior) cq_product_resilient_rec_rev_qtd_2w_prior,
        SUM(cq_ebr_usd_rec_rev_qtd_2w_prior) cq_ebr_usd_rec_rev_qtd_2w_prior,
        SUM(cq_capi_ebr_revenue_qtd_2w_prior) cq_capi_ebr_revenue_qtd_2w_prior,
        SUM(l14d_product_resilient_rec_rev_prior) l14d_product_resilient_rec_rev_prior,
        SUM(l14d_ebr_usd_rec_rev_prior) l14d_ebr_usd_rec_rev_prior,
        SUM(l14d_capi_ebr_revenue_prior) l14d_capi_ebr_revenue_prior,
        SUM(l14d_avg_product_resilient_rec_rev_prior) l14d_avg_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ebr_usd_rec_rev_prior) l14d_avg_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_capi_ebr_revenue_prior) l14d_avg_capi_ebr_revenue_prior,
        SUM(l14d_avg_ly_product_resilient_rec_rev_prior) l14d_avg_ly_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ly_ebr_usd_rec_rev_prior) l14d_avg_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_ly_capi_ebr_revenue_prior) l14d_avg_ly_capi_ebr_revenue_prior,
        SUM(l14d_ly_product_resilient_rec_rev_prior) l14d_ly_product_resilient_rec_rev_prior,
        SUM(l14d_ly_ebr_usd_rec_rev_prior) l14d_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_ly_capi_ebr_revenue_prior) l14d_ly_capi_ebr_revenue_prior,
        SUM(L14d_revenue) l14d_revenue,
        SUM(L14d_revenue_prior) l14d_revenue_prior,
        SUM(L14d_avg_revenue) l14d_avg_revenue,
        revenue_segment,
        'Advertiser' route_to_market
from

bpo_gms_quota_and_forecast_fast

where cp_username is not null or am_username is not null

group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,revenue_segment
       """,
)

bpo_gms_quota_and_forecast_rtm_agency = PrestoInsertOperatorWithSchema(
    dep_list=[bpo_gms_quota_and_forecast_rtm_advertiser],
    table="<TABLE:bpo_gms_quota_and_forecast_rtm_fast>",
    partition="ds=<DATEID>/route_to_market=Agency",
    documentation={
        "description": """Creates a Subpartition for Agency on Route to Market"""
    },
    create=Table(
        cols=[
            Column('ultimate_client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('ultimate_client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('program', 'VARCHAR','', HiveAnon.NONE),
            Column('vertical', 'VARCHAR','', HiveAnon.NONE),
            Column('segmentation', 'VARCHAR','', HiveAnon.NONE),
            Column('asofdate', 'VARCHAR','', HiveAnon.NONE),
            Column('quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('next_quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('days_left_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_left_in_quarter_prior', 'BIGINT','', HiveAnon.NONE),
            Column('days_total_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_closed_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('l12_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l4_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l2_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_subregion', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_region', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_market', 'VARCHAR','', HiveAnon.NONE),
            Column('country', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('run_rate_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('quota', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('employee_type_1', 'VARCHAR','', HiveAnon.NONE),
            Column('employee_type_2', 'VARCHAR','', HiveAnon.NONE),
            Column('l12_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('revenue_segment', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_product_resilient_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_ebr_usd_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_capi_ebr_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
        ],
        partitions=[
            Column('ds', 'VARCHAR', 'datestamp'),
            Column('route_to_market', 'VARCHAR', ''),
        ],
        retention=15,
    ),
    select=r"""
        Select
        planning_agency_ult_fbid ultimate_client_fbid ,
        planning_agency_ult_name ultimate_client_name ,
        planning_agency_name client_name ,
        planning_agency_fbid client_fbid ,
        program_agency program,
        'Not Available' vertical ,
        'Not Available' segmentation ,
        asofdate ,
        quarter_id ,
        next_quarter_id ,
        days_left_in_quarter ,
        days_left_in_quarter_prior ,
        days_total_in_quarter ,
        days_closed_in_quarter ,
        l12_agency_territory l12_territory ,
        l10_agency_territory l10_territory ,
        l8_agency_territory l8_territory  ,
        l6_agency_territory l6_territory  ,
        l4_agency_territory l4_territory  ,
        l2_agency_territory l2_territory  ,
        sub_region_agc fb_subregion ,
        region_agc fb_region ,
        market_agc fb_market ,
        country_agc country ,
        ap_username employee_type_1,
        pm_username employee_type_2,
        l12_manager_agency_territory l12_territory_mgr,
        l10_manager_agency_territory l10_territory_mgr,
        l8_manager_agency_territory l8_territory_mgr,
        l6_manager_agency_territory l6_territory_mgr,
        SUM(run_rate_forecast) run_rate_forecast,
        SUM(run_rate_forecast_prior) run_rate_forecast_prior,
        SUM(agency_quota) quota,
        null sales_forecast,
        null sales_forecast_prior,
        SUM(cq_revenue) cq_revenue,
        SUM(pq_revenue) pq_revenue,
        SUM(cq_revenue_qtd_prior) cq_revenue_qtd_prior,
        SUM(lyq_revenue) lyq_revenue,
        SUM(l2yq_revenue) l2yq_revenue,
        SUM(lyq_revenue_qtd) lyq_revenue_qtd,
        SUM(l2yq_revenue_qtd) l2yq_revenue_qtd,
        SUM(lyq_revenue_qtd_prior) lyq_revenue_qtd_prior,
        SUM(l2yq_revenue_qtd_prior) l2yq_revenue_qtd_prior,
        SUM(pq_revenue_qtd) pq_revenue_qtd,
        SUM(l7d_revenue) l7d_revenue,
        SUM(l7d_revenue_prior) l7d_revenue_prior,
        SUM(l7d_avg_revenue) l7d_avg_revenue,
        SUM(l7d_avg_revenue_prior) l7d_avg_revenue_prior,
        SUM(l7d_avg_ly_revenue) l7d_avg_ly_revenue,
        SUM(l7d_avg_ly_revenue_prior) l7d_avg_ly_revenue_prior,
        SUM(l7d_ly_revenue) l7d_ly_revenue,
        SUM(l7d_ly_revenue_prior) l7d_ly_revenue_prior,
        SUM(run_rate_forecast_2w_prior) run_rate_forecast_2w_prior,
        SUM(cq_revenue_qtd_2w_prior) cq_revenue_qtd_2w_prior,
        SUM(lyq_revenue_qtd_2w_prior) lyq_revenue_qtd_2w_prior,
        SUM(l2yq_revenue_qtd_2w_prior) l2yq_revenue_qtd_2w_prior,
        SUM(l14d_avg_revenue_prior) l14d_avg_revenue_prior,
        SUM(cq_optimal_qtd_2w_prior) cq_optimal_qtd_2w_prior,
        SUM(lyq_optimal_qtd_2w_prior) lyq_optimal_qtd_2w_prior,
        SUM(l14d_optimal_prior) l14d_optimal_prior,
        SUM(l14d_avg_optimal_prior) l14d_avg_optimal_prior,
        SUM(l14d_avg_ly_optimal_prior) l14d_avg_ly_optimal_prior,
        SUM(l14d_ly_optimal_prior) l14d_ly_optimal_prior,
        SUM(cq_dr_resilient_qtd_2w_prior) cq_dr_resilient_qtd_2w_prior,
        SUM(lyq_dr_resilient_qtd_2w_prior) lyq_dr_resilient_qtd_2w_prior,
        SUM(l14d_dr_resilient_prior) l14d_dr_resilient_prior,
        SUM(l14d_avg_dr_resilient_prior) l14d_avg_dr_resilient_prior,
        SUM(l14d_avg_ly_dr_resilient_prior) l14d_avg_ly_dr_resilient_prior,
        SUM(l14d_ly_dr_resilient_prior) l14d_ly_dr_resilient_prior,
        SUM(cq_product_resilient_rec_rev_qtd_2w_prior) cq_product_resilient_rec_rev_qtd_2w_prior,
        SUM(cq_ebr_usd_rec_rev_qtd_2w_prior) cq_ebr_usd_rec_rev_qtd_2w_prior,
        SUM(cq_capi_ebr_revenue_qtd_2w_prior) cq_capi_ebr_revenue_qtd_2w_prior,
        SUM(l14d_product_resilient_rec_rev_prior) l14d_product_resilient_rec_rev_prior,
        SUM(l14d_ebr_usd_rec_rev_prior) l14d_ebr_usd_rec_rev_prior,
        SUM(l14d_capi_ebr_revenue_prior) l14d_capi_ebr_revenue_prior,
        SUM(l14d_avg_product_resilient_rec_rev_prior) l14d_avg_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ebr_usd_rec_rev_prior) l14d_avg_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_capi_ebr_revenue_prior) l14d_avg_capi_ebr_revenue_prior,
        SUM(l14d_avg_ly_product_resilient_rec_rev_prior) l14d_avg_ly_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ly_ebr_usd_rec_rev_prior) l14d_avg_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_ly_capi_ebr_revenue_prior) l14d_avg_ly_capi_ebr_revenue_prior,
        SUM(l14d_ly_product_resilient_rec_rev_prior) l14d_ly_product_resilient_rec_rev_prior,
        SUM(l14d_ly_ebr_usd_rec_rev_prior) l14d_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_ly_capi_ebr_revenue_prior) l14d_ly_capi_ebr_revenue_prior,
        SUM(L14d_revenue) l14d_revenue,
        SUM(L14d_revenue_prior) l14d_revenue_prior,
        SUM(L14d_avg_revenue) l14d_avg_revenue,
        program_agency revenue_segment,
        'Agency' route_to_market
from

bpo_gms_quota_and_forecast_fast

where ap_username is not null or pm_username is not null

group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,revenue_segment

    """,
)

bpo_gms_quota_and_forecast_rtm_reseller = PrestoInsertOperatorWithSchema(
    dep_list=[bpo_gms_quota_and_forecast_rtm_agency],
    table="<TABLE:bpo_gms_quota_and_forecast_rtm_fast>",
    partition="ds=<DATEID>/route_to_market=Reseller",
    documentation={
        "description": """Creates a Subpartition for Reseller on Route to Market"""
    },
    create=Table(
        cols=[
            Column('ultimate_client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('ultimate_client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('program', 'VARCHAR','', HiveAnon.NONE),
            Column('vertical', 'VARCHAR','', HiveAnon.NONE),
            Column('segmentation', 'VARCHAR','', HiveAnon.NONE),
            Column('asofdate', 'VARCHAR','', HiveAnon.NONE),
            Column('quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('next_quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('days_left_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_left_in_quarter_prior', 'BIGINT','', HiveAnon.NONE),
            Column('days_total_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_closed_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('l12_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l4_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l2_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_subregion', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_region', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_market', 'VARCHAR','', HiveAnon.NONE),
            Column('country', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('run_rate_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('quota', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('employee_type_1', 'VARCHAR','', HiveAnon.NONE),
            Column('employee_type_2', 'VARCHAR','', HiveAnon.NONE),
            Column('l12_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('revenue_segment', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_product_resilient_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_ebr_usd_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_capi_ebr_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
        ],
        partitions=[
            Column('ds', 'VARCHAR', 'datestamp'),
            Column('route_to_market', 'VARCHAR', ''),
        ],
        retention=15,
    ),
    select=r"""
        Select
        reseller_fbid ultimate_client_fbid ,
        reseller_name ultimate_client_name ,
        reseller_name client_name ,
        reseller_fbid client_fbid ,
        'Reseller' program,
        'Not Available' vertical ,
        'Not Available' segmentation ,
        asofdate ,
        quarter_id ,
        next_quarter_id ,
        days_left_in_quarter ,
        days_left_in_quarter_prior ,
        days_total_in_quarter ,
        days_closed_in_quarter ,
        l12_reseller_territory l12_territory ,
        l10_reseller_territory l10_territory ,
        l8_reseller_territory l8_territory  ,
        l6_reseller_territory l6_territory  ,
        l4_reseller_territory l4_territory  ,
        l2_reseller_territory l2_territory  ,
        'Not Available' fb_subregion ,
        'Not Available' fb_region ,
        'Not Available' fb_market ,
        'Not Available' country ,
        rp_username employee_type_1,
        null employee_type_2,
        l12_reseller_terr_mgr l12_territory_mgr,
        l10_reseller_terr_mgr l10_territory_mgr,
        l8_reseller_terr_mgr l8_territory_mgr,
        l6_reseller_terr_mgr l6_territory_mgr,
        SUM(run_rate_forecast) run_rate_forecast,
        SUM(run_rate_forecast_prior) run_rate_forecast_prior,
        SUM(reseller_quota) quota,
        null sales_forecast,
        null sales_forecast_prior,
        SUM(cq_revenue) cq_revenue,
        SUM(pq_revenue) pq_revenue,
        SUM(cq_revenue_qtd_prior) cq_revenue_qtd_prior,
        SUM(lyq_revenue) lyq_revenue,
        SUM(l2yq_revenue) l2yq_revenue,
        SUM(lyq_revenue_qtd) lyq_revenue_qtd,
        SUM(l2yq_revenue_qtd) l2yq_revenue_qtd,
        SUM(lyq_revenue_qtd_prior) lyq_revenue_qtd_prior,
        SUM(l2yq_revenue_qtd_prior) l2yq_revenue_qtd_prior,
        SUM(pq_revenue_qtd) pq_revenue_qtd,
        SUM(l7d_revenue) l7d_revenue,
        SUM(l7d_revenue_prior) l7d_revenue_prior,
        SUM(l7d_avg_revenue) l7d_avg_revenue,
        SUM(l7d_avg_revenue_prior) l7d_avg_revenue_prior,
        SUM(l7d_avg_ly_revenue) l7d_avg_ly_revenue,
        SUM(l7d_avg_ly_revenue_prior) l7d_avg_ly_revenue_prior,
        SUM(l7d_ly_revenue) l7d_ly_revenue,
        SUM(l7d_ly_revenue_prior) l7d_ly_revenue_prior,
        SUM(run_rate_forecast_2w_prior) run_rate_forecast_2w_prior,
        SUM(cq_revenue_qtd_2w_prior) cq_revenue_qtd_2w_prior,
        SUM(lyq_revenue_qtd_2w_prior) lyq_revenue_qtd_2w_prior,
        SUM(l2yq_revenue_qtd_2w_prior) l2yq_revenue_qtd_2w_prior,
        SUM(l14d_avg_revenue_prior) l14d_avg_revenue_prior,
        SUM(cq_optimal_qtd_2w_prior) cq_optimal_qtd_2w_prior,
        SUM(lyq_optimal_qtd_2w_prior) lyq_optimal_qtd_2w_prior,
        SUM(l14d_optimal_prior) l14d_optimal_prior,
        SUM(l14d_avg_optimal_prior) l14d_avg_optimal_prior,
        SUM(l14d_avg_ly_optimal_prior) l14d_avg_ly_optimal_prior,
        SUM(l14d_ly_optimal_prior) l14d_ly_optimal_prior,
        SUM(cq_dr_resilient_qtd_2w_prior) cq_dr_resilient_qtd_2w_prior,
        SUM(lyq_dr_resilient_qtd_2w_prior) lyq_dr_resilient_qtd_2w_prior,
        SUM(l14d_dr_resilient_prior) l14d_dr_resilient_prior,
        SUM(l14d_avg_dr_resilient_prior) l14d_avg_dr_resilient_prior,
        SUM(l14d_avg_ly_dr_resilient_prior) l14d_avg_ly_dr_resilient_prior,
        SUM(l14d_ly_dr_resilient_prior) l14d_ly_dr_resilient_prior,
        SUM(cq_product_resilient_rec_rev_qtd_2w_prior) cq_product_resilient_rec_rev_qtd_2w_prior,
        SUM(cq_ebr_usd_rec_rev_qtd_2w_prior) cq_ebr_usd_rec_rev_qtd_2w_prior,
        SUM(cq_capi_ebr_revenue_qtd_2w_prior) cq_capi_ebr_revenue_qtd_2w_prior,
        SUM(l14d_product_resilient_rec_rev_prior) l14d_product_resilient_rec_rev_prior,
        SUM(l14d_ebr_usd_rec_rev_prior) l14d_ebr_usd_rec_rev_prior,
        SUM(l14d_capi_ebr_revenue_prior) l14d_capi_ebr_revenue_prior,
        SUM(l14d_avg_product_resilient_rec_rev_prior) l14d_avg_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ebr_usd_rec_rev_prior) l14d_avg_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_capi_ebr_revenue_prior) l14d_avg_capi_ebr_revenue_prior,
        SUM(l14d_avg_ly_product_resilient_rec_rev_prior) l14d_avg_ly_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ly_ebr_usd_rec_rev_prior) l14d_avg_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_ly_capi_ebr_revenue_prior) l14d_avg_ly_capi_ebr_revenue_prior,
        SUM(l14d_ly_product_resilient_rec_rev_prior) l14d_ly_product_resilient_rec_rev_prior,
        SUM(l14d_ly_ebr_usd_rec_rev_prior) l14d_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_ly_capi_ebr_revenue_prior) l14d_ly_capi_ebr_revenue_prior,
        SUM(L14d_revenue) l14d_revenue,
        SUM(L14d_revenue_prior) l14d_revenue_prior,
        SUM(L14d_avg_revenue) l14d_avg_revenue,
        revenue_segment,
        'Reseller' route_to_market
from

bpo_gms_quota_and_forecast_fast

where rp_username is not null

group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,revenue_segment

    """,
)

bpo_gms_quota_and_forecast_rtm_reporting = PrestoInsertOperatorWithSchema(
    dep_list=[bpo_gms_quota_and_forecast_rtm_reseller],
    table="<TABLE:bpo_gms_quota_and_forecast_rtm_fast>",
    partition="ds=<DATEID>/route_to_market=Reporting",
    documentation={
        "description": """Creates a Subpartition for Reporting on Route to Market"""
    },
    create=Table(
        cols=[
            Column('ultimate_client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('ultimate_client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('program', 'VARCHAR','', HiveAnon.NONE),
            Column('vertical', 'VARCHAR','', HiveAnon.NONE),
            Column('segmentation', 'VARCHAR','', HiveAnon.NONE),
            Column('asofdate', 'VARCHAR','', HiveAnon.NONE),
            Column('quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('next_quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('days_left_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_left_in_quarter_prior', 'BIGINT','', HiveAnon.NONE),
            Column('days_total_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_closed_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('l12_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l4_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l2_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_subregion', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_region', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_market', 'VARCHAR','', HiveAnon.NONE),
            Column('country', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('run_rate_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('quota', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('employee_type_1', 'VARCHAR','', HiveAnon.NONE),
            Column('employee_type_2', 'VARCHAR','', HiveAnon.NONE),
            Column('l12_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('revenue_segment', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_product_resilient_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_ebr_usd_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_capi_ebr_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
        ],
        partitions=[
            Column('ds', 'VARCHAR', 'datestamp'),
            Column('route_to_market', 'VARCHAR', ''),
        ],
        retention=15,
    ),
    select=r"""
        Select
        case when revenue_segment like '%SBG%' then null else ultimate_parent_fbid end ultimate_client_fbid ,
        case when revenue_segment like '%SBG%' then null else ultimate_parent_name end ultimate_client_name ,
        case when revenue_segment like '%SBG%' then null else advertiser_name end client_name ,
        case when revenue_segment like '%SBG%' then null else advertiser_fbid end client_fbid ,
        program ,
        advertiser_vertical vertical ,
        segmentation ,
        asofdate ,
        quarter_id ,
        next_quarter_id ,
        days_left_in_quarter ,
        days_left_in_quarter_prior ,
        days_total_in_quarter ,
        days_closed_in_quarter ,
        l12_reporting_territory l12_territory ,
        l10_reporting_territory l10_territory ,
        l8_reporting_territory l8_territory  ,
        l6_reporting_territory l6_territory  ,
        l4_reporting_territory l4_territory  ,
        l2_reporting_territory l2_territory  ,
        sales_adv_subregion fb_subregion ,
        sales_adv_region fb_region ,
        market fb_market ,
        advertiser_country country ,
        cp_username employee_type_1,
        am_username employee_type_2,
        l12_reporting_terr_mgr l12_territory_mgr,
        l10_reporting_terr_mgr l10_territory_mgr,
        l8_reporting_terr_mgr l8_territory_mgr,
        l6_reporting_terr_mgr l6_territory_mgr,
        SUM(run_rate_forecast) run_rate_forecast,
        SUM(run_rate_forecast_prior) run_rate_forecast_prior,
        SUM(advertiser_quota) quota,
        SUM(sales_forecast) sales_forecast,
        SUM(sales_forecast_prior) sales_forecast_prior,
        SUM(cq_revenue) cq_revenue,
        SUM(pq_revenue) pq_revenue,
        SUM(cq_revenue_qtd_prior) cq_revenue_qtd_prior,
        SUM(lyq_revenue) lyq_revenue,
        SUM(l2yq_revenue) l2yq_revenue,
        SUM(lyq_revenue_qtd) lyq_revenue_qtd,
        SUM(l2yq_revenue_qtd) l2yq_revenue_qtd,
        SUM(lyq_revenue_qtd_prior) lyq_revenue_qtd_prior,
        SUM(l2yq_revenue_qtd_prior) l2yq_revenue_qtd_prior,
        SUM(pq_revenue_qtd) pq_revenue_qtd,
        SUM(l7d_revenue) l7d_revenue,
        SUM(l7d_revenue_prior) l7d_revenue_prior,
        SUM(l7d_avg_revenue) l7d_avg_revenue,
        SUM(l7d_avg_revenue_prior) l7d_avg_revenue_prior,
        SUM(l7d_avg_ly_revenue) l7d_avg_ly_revenue,
        SUM(l7d_avg_ly_revenue_prior) l7d_avg_ly_revenue_prior,
        SUM(l7d_ly_revenue) l7d_ly_revenue,
        SUM(l7d_ly_revenue_prior) l7d_ly_revenue_prior,
        SUM(run_rate_forecast_2w_prior) run_rate_forecast_2w_prior,
        SUM(cq_revenue_qtd_2w_prior) cq_revenue_qtd_2w_prior,
        SUM(lyq_revenue_qtd_2w_prior) lyq_revenue_qtd_2w_prior,
        SUM(l2yq_revenue_qtd_2w_prior) l2yq_revenue_qtd_2w_prior,
        SUM(l14d_avg_revenue_prior) l14d_avg_revenue_prior,
        SUM(cq_optimal_qtd_2w_prior) cq_optimal_qtd_2w_prior,
        SUM(lyq_optimal_qtd_2w_prior) lyq_optimal_qtd_2w_prior,
        SUM(l14d_optimal_prior) l14d_optimal_prior,
        SUM(l14d_avg_optimal_prior) l14d_avg_optimal_prior,
        SUM(l14d_avg_ly_optimal_prior) l14d_avg_ly_optimal_prior,
        SUM(l14d_ly_optimal_prior) l14d_ly_optimal_prior,
        SUM(cq_dr_resilient_qtd_2w_prior) cq_dr_resilient_qtd_2w_prior,
        SUM(lyq_dr_resilient_qtd_2w_prior) lyq_dr_resilient_qtd_2w_prior,
        SUM(l14d_dr_resilient_prior) l14d_dr_resilient_prior,
        SUM(l14d_avg_dr_resilient_prior) l14d_avg_dr_resilient_prior,
        SUM(l14d_avg_ly_dr_resilient_prior) l14d_avg_ly_dr_resilient_prior,
        SUM(l14d_ly_dr_resilient_prior) l14d_ly_dr_resilient_prior,
        SUM(cq_product_resilient_rec_rev_qtd_2w_prior) cq_product_resilient_rec_rev_qtd_2w_prior,
        SUM(cq_ebr_usd_rec_rev_qtd_2w_prior) cq_ebr_usd_rec_rev_qtd_2w_prior,
        SUM(cq_capi_ebr_revenue_qtd_2w_prior) cq_capi_ebr_revenue_qtd_2w_prior,
        SUM(l14d_product_resilient_rec_rev_prior) l14d_product_resilient_rec_rev_prior,
        SUM(l14d_ebr_usd_rec_rev_prior) l14d_ebr_usd_rec_rev_prior,
        SUM(l14d_capi_ebr_revenue_prior) l14d_capi_ebr_revenue_prior,
        SUM(l14d_avg_product_resilient_rec_rev_prior) l14d_avg_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ebr_usd_rec_rev_prior) l14d_avg_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_capi_ebr_revenue_prior) l14d_avg_capi_ebr_revenue_prior,
        SUM(l14d_avg_ly_product_resilient_rec_rev_prior) l14d_avg_ly_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ly_ebr_usd_rec_rev_prior) l14d_avg_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_ly_capi_ebr_revenue_prior) l14d_avg_ly_capi_ebr_revenue_prior,
        SUM(l14d_ly_product_resilient_rec_rev_prior) l14d_ly_product_resilient_rec_rev_prior,
        SUM(l14d_ly_ebr_usd_rec_rev_prior) l14d_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_ly_capi_ebr_revenue_prior) l14d_ly_capi_ebr_revenue_prior,
        SUM(L14d_revenue) l14d_revenue,
        SUM(L14d_revenue_prior) l14d_revenue_prior,
        SUM(L14d_avg_revenue) l14d_avg_revenue,
        revenue_segment,
        'Reporting' route_to_market
from

bpo_gms_quota_and_forecast_fast

group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,revenue_segment

    """,
)

bpo_gms_quota_and_forecast_rtm_overlap = PrestoInsertOperatorWithSchema(
    dep_list=[bpo_gms_quota_and_forecast_rtm_reporting],
    table="<TABLE:bpo_gms_quota_and_forecast_rtm_fast>",
    partition="ds=<DATEID>/route_to_market=Route to Market Overlap",
    documentation={
        "description": """Creates a Subpartition for Overlap on Route to Market"""
    },
    create=Table(
        cols=[
            Column('ultimate_client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('ultimate_client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('program', 'VARCHAR','', HiveAnon.NONE),
            Column('vertical', 'VARCHAR','', HiveAnon.NONE),
            Column('segmentation', 'VARCHAR','', HiveAnon.NONE),
            Column('asofdate', 'VARCHAR','', HiveAnon.NONE),
            Column('quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('next_quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('days_left_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_left_in_quarter_prior', 'BIGINT','', HiveAnon.NONE),
            Column('days_total_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_closed_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('l12_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l4_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l2_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_subregion', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_region', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_market', 'VARCHAR','', HiveAnon.NONE),
            Column('country', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('run_rate_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('quota', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('employee_type_1', 'VARCHAR','', HiveAnon.NONE),
            Column('employee_type_2', 'VARCHAR','', HiveAnon.NONE),
            Column('l12_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('revenue_segment', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_product_resilient_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_ebr_usd_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_capi_ebr_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
        ],
        partitions=[
            Column('ds', 'VARCHAR', 'datestamp'),
            Column('route_to_market', 'VARCHAR', ''),
        ],
        retention=15,
    ),
    select=r"""
        Select
        ultimate_parent_fbid ultimate_client_fbid ,
        ultimate_parent_name ultimate_client_name ,
        advertiser_name client_name ,
        advertiser_fbid client_fbid ,
        program ,
        advertiser_vertical vertical ,
        segmentation ,
        asofdate ,
        quarter_id ,
        next_quarter_id ,
        days_left_in_quarter ,
        days_left_in_quarter_prior ,
        days_total_in_quarter ,
        days_closed_in_quarter ,
        l12_reporting_territory l12_territory ,
        l10_reporting_territory l10_territory ,
        l8_reporting_territory l8_territory  ,
        l6_reporting_territory l6_territory  ,
        l4_reporting_territory l4_territory  ,
        l2_reporting_territory l2_territory  ,
        sales_adv_subregion fb_subregion ,
        sales_adv_region fb_region ,
        market fb_market ,
        advertiser_country country ,
        cp_username employee_type_1,
        pm_username employee_type_2,
        l12_reporting_terr_mgr l12_territory_mgr,
        l10_reporting_terr_mgr l10_territory_mgr,
        l8_reporting_terr_mgr l8_territory_mgr,
        l6_reporting_terr_mgr l6_territory_mgr,
        SUM(run_rate_forecast) run_rate_forecast,
        SUM(run_rate_forecast_prior) run_rate_forecast_prior,
        SUM(advertiser_quota) quota,
        SUM(sales_forecast) sales_forecast,
        SUM(sales_forecast_prior) sales_forecast_prior,
        SUM(cq_revenue) cq_revenue,
        SUM(pq_revenue) pq_revenue,
        SUM(cq_revenue_qtd_prior) cq_revenue_qtd_prior,
        SUM(lyq_revenue) lyq_revenue,
        SUM(l2yq_revenue) l2yq_revenue,
        SUM(lyq_revenue_qtd) lyq_revenue_qtd,
        SUM(l2yq_revenue_qtd) l2yq_revenue_qtd,
        SUM(lyq_revenue_qtd_prior) lyq_revenue_qtd_prior,
        SUM(l2yq_revenue_qtd_prior) l2yq_revenue_qtd_prior,
        SUM(pq_revenue_qtd) pq_revenue_qtd,
        SUM(l7d_revenue) l7d_revenue,
        SUM(l7d_revenue_prior) l7d_revenue_prior,
        SUM(l7d_avg_revenue) l7d_avg_revenue,
        SUM(l7d_avg_revenue_prior) l7d_avg_revenue_prior,
        SUM(l7d_avg_ly_revenue) l7d_avg_ly_revenue,
        SUM(l7d_avg_ly_revenue_prior) l7d_avg_ly_revenue_prior,
        SUM(l7d_ly_revenue) l7d_ly_revenue,
        SUM(l7d_ly_revenue_prior) l7d_ly_revenue_prior,
        SUM(run_rate_forecast_2w_prior) run_rate_forecast_2w_prior,
        SUM(cq_revenue_qtd_2w_prior) cq_revenue_qtd_2w_prior,
        SUM(lyq_revenue_qtd_2w_prior) lyq_revenue_qtd_2w_prior,
        SUM(l2yq_revenue_qtd_2w_prior) l2yq_revenue_qtd_2w_prior,
        SUM(l14d_avg_revenue_prior) l14d_avg_revenue_prior,
        SUM(cq_optimal_qtd_2w_prior) cq_optimal_qtd_2w_prior,
        SUM(lyq_optimal_qtd_2w_prior) lyq_optimal_qtd_2w_prior,
        SUM(l14d_optimal_prior) l14d_optimal_prior,
        SUM(l14d_avg_optimal_prior) l14d_avg_optimal_prior,
        SUM(l14d_avg_ly_optimal_prior) l14d_avg_ly_optimal_prior,
        SUM(l14d_ly_optimal_prior) l14d_ly_optimal_prior,
        SUM(cq_dr_resilient_qtd_2w_prior) cq_dr_resilient_qtd_2w_prior,
        SUM(lyq_dr_resilient_qtd_2w_prior) lyq_dr_resilient_qtd_2w_prior,
        SUM(l14d_dr_resilient_prior) l14d_dr_resilient_prior,
        SUM(l14d_avg_dr_resilient_prior) l14d_avg_dr_resilient_prior,
        SUM(l14d_avg_ly_dr_resilient_prior) l14d_avg_ly_dr_resilient_prior,
        SUM(l14d_ly_dr_resilient_prior) l14d_ly_dr_resilient_prior,
        SUM(cq_product_resilient_rec_rev_qtd_2w_prior) cq_product_resilient_rec_rev_qtd_2w_prior,
        SUM(cq_ebr_usd_rec_rev_qtd_2w_prior) cq_ebr_usd_rec_rev_qtd_2w_prior,
        SUM(cq_capi_ebr_revenue_qtd_2w_prior) cq_capi_ebr_revenue_qtd_2w_prior,
        SUM(l14d_product_resilient_rec_rev_prior) l14d_product_resilient_rec_rev_prior,
        SUM(l14d_ebr_usd_rec_rev_prior) l14d_ebr_usd_rec_rev_prior,
        SUM(l14d_capi_ebr_revenue_prior) l14d_capi_ebr_revenue_prior,
        SUM(l14d_avg_product_resilient_rec_rev_prior) l14d_avg_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ebr_usd_rec_rev_prior) l14d_avg_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_capi_ebr_revenue_prior) l14d_avg_capi_ebr_revenue_prior,
        SUM(l14d_avg_ly_product_resilient_rec_rev_prior) l14d_avg_ly_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ly_ebr_usd_rec_rev_prior) l14d_avg_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_ly_capi_ebr_revenue_prior) l14d_avg_ly_capi_ebr_revenue_prior,
        SUM(l14d_ly_product_resilient_rec_rev_prior) l14d_ly_product_resilient_rec_rev_prior,
        SUM(l14d_ly_ebr_usd_rec_rev_prior) l14d_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_ly_capi_ebr_revenue_prior) l14d_ly_capi_ebr_revenue_prior,
        SUM(L14d_revenue) l14d_revenue,
        SUM(L14d_revenue_prior) l14d_revenue_prior,
        SUM(L14d_avg_revenue) l14d_avg_revenue,
        revenue_segment,
        'Route to Market Overlap' route_to_market
from

bpo_gms_quota_and_forecast_fast

where
(cp_username is not null and ap_username is not null) or
(am_username is not null and pm_username is not null) or
(pm_username is not null and cp_username is not null) or
(am_username is not null and cp_username is not null) or
(am_username is not null and cp_username is not null) or
(ap_username is not null and pm_username is not null) or
(ap_username is not null and am_username is not null) or
(rp_username is not null and cp_username is not null) or
(rp_username is not null and ap_username is not null) or
(rp_username is not null and pm_username is not null) or
(rp_username is not null and am_username is not null)

group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,revenue_segment

    """,
)

bpo_gms_quota_and_forecast_rtm_cp_ap_overlap = PrestoInsertOperatorWithSchema(
    dep_list=[bpo_gms_quota_and_forecast_rtm_reporting],
    table="<TABLE:bpo_gms_quota_and_forecast_rtm_fast>",
    partition="ds=<DATEID>/route_to_market=CP|AP Overlap",
    documentation={
        "description": """Creates a Subpartition for CP|AP Overlap on Route to Market"""
    },
    create=Table(
        cols=[
            Column('ultimate_client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('ultimate_client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('program', 'VARCHAR','', HiveAnon.NONE),
            Column('vertical', 'VARCHAR','', HiveAnon.NONE),
            Column('segmentation', 'VARCHAR','', HiveAnon.NONE),
            Column('asofdate', 'VARCHAR','', HiveAnon.NONE),
            Column('quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('next_quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('days_left_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_left_in_quarter_prior', 'BIGINT','', HiveAnon.NONE),
            Column('days_total_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_closed_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('l12_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l4_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l2_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_subregion', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_region', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_market', 'VARCHAR','', HiveAnon.NONE),
            Column('country', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('run_rate_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('quota', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('employee_type_1', 'VARCHAR','', HiveAnon.NONE),
            Column('employee_type_2', 'VARCHAR','', HiveAnon.NONE),
            Column('l12_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('revenue_segment', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_product_resilient_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_ebr_usd_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_capi_ebr_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
        ],
        partitions=[
            Column('ds', 'VARCHAR', 'datestamp'),
            Column('route_to_market', 'VARCHAR', ''),
        ],
        retention=15,
    ),
    select=r"""
        Select
        ultimate_parent_fbid ultimate_client_fbid ,
        ultimate_parent_name ultimate_client_name ,
        advertiser_name client_name ,
        advertiser_fbid client_fbid ,
        program ,
        advertiser_vertical vertical ,
        segmentation ,
        asofdate ,
        quarter_id ,
        next_quarter_id ,
        days_left_in_quarter ,
        days_left_in_quarter_prior ,
        days_total_in_quarter ,
        days_closed_in_quarter ,
        l12_reporting_territory l12_territory ,
        l10_reporting_territory l10_territory ,
        l8_reporting_territory l8_territory  ,
        l6_reporting_territory l6_territory  ,
        l4_reporting_territory l4_territory  ,
        l2_reporting_territory l2_territory  ,
        sales_adv_subregion fb_subregion ,
        sales_adv_region fb_region ,
        market fb_market ,
        advertiser_country country ,
        cp_username employee_type_1,
        ap_username employee_type_2,
        l12_reporting_terr_mgr l12_territory_mgr,
        l10_reporting_terr_mgr l10_territory_mgr,
        l8_reporting_terr_mgr l8_territory_mgr,
        l6_reporting_terr_mgr l6_territory_mgr,
        SUM(run_rate_forecast) run_rate_forecast,
        SUM(run_rate_forecast_prior) run_rate_forecast_prior,
        SUM(advertiser_quota) quota,
        SUM(sales_forecast) sales_forecast,
        SUM(sales_forecast_prior) sales_forecast_prior,
        SUM(cq_revenue) cq_revenue,
        SUM(pq_revenue) pq_revenue,
        SUM(cq_revenue_qtd_prior) cq_revenue_qtd_prior,
        SUM(lyq_revenue) lyq_revenue,
        SUM(l2yq_revenue) l2yq_revenue,
        SUM(lyq_revenue_qtd) lyq_revenue_qtd,
        SUM(l2yq_revenue_qtd) l2yq_revenue_qtd,
        SUM(lyq_revenue_qtd_prior) lyq_revenue_qtd_prior,
        SUM(l2yq_revenue_qtd_prior) l2yq_revenue_qtd_prior,
        SUM(pq_revenue_qtd) pq_revenue_qtd,
        SUM(l7d_revenue) l7d_revenue,
        SUM(l7d_revenue_prior) l7d_revenue_prior,
        SUM(l7d_avg_revenue) l7d_avg_revenue,
        SUM(l7d_avg_revenue_prior) l7d_avg_revenue_prior,
        SUM(l7d_avg_ly_revenue) l7d_avg_ly_revenue,
        SUM(l7d_avg_ly_revenue_prior) l7d_avg_ly_revenue_prior,
        SUM(l7d_ly_revenue) l7d_ly_revenue,
        SUM(l7d_ly_revenue_prior) l7d_ly_revenue_prior,
        SUM(run_rate_forecast_2w_prior) run_rate_forecast_2w_prior,
        SUM(cq_revenue_qtd_2w_prior) cq_revenue_qtd_2w_prior,
        SUM(lyq_revenue_qtd_2w_prior) lyq_revenue_qtd_2w_prior,
        SUM(l2yq_revenue_qtd_2w_prior) l2yq_revenue_qtd_2w_prior,
        SUM(l14d_avg_revenue_prior) l14d_avg_revenue_prior,
        SUM(cq_optimal_qtd_2w_prior) cq_optimal_qtd_2w_prior,
        SUM(lyq_optimal_qtd_2w_prior) lyq_optimal_qtd_2w_prior,
        SUM(l14d_optimal_prior) l14d_optimal_prior,
        SUM(l14d_avg_optimal_prior) l14d_avg_optimal_prior,
        SUM(l14d_avg_ly_optimal_prior) l14d_avg_ly_optimal_prior,
        SUM(l14d_ly_optimal_prior) l14d_ly_optimal_prior,
        SUM(cq_dr_resilient_qtd_2w_prior) cq_dr_resilient_qtd_2w_prior,
        SUM(lyq_dr_resilient_qtd_2w_prior) lyq_dr_resilient_qtd_2w_prior,
        SUM(l14d_dr_resilient_prior) l14d_dr_resilient_prior,
        SUM(l14d_avg_dr_resilient_prior) l14d_avg_dr_resilient_prior,
        SUM(l14d_avg_ly_dr_resilient_prior) l14d_avg_ly_dr_resilient_prior,
        SUM(l14d_ly_dr_resilient_prior) l14d_ly_dr_resilient_prior,
        SUM(cq_product_resilient_rec_rev_qtd_2w_prior) cq_product_resilient_rec_rev_qtd_2w_prior,
        SUM(cq_ebr_usd_rec_rev_qtd_2w_prior) cq_ebr_usd_rec_rev_qtd_2w_prior,
        SUM(cq_capi_ebr_revenue_qtd_2w_prior) cq_capi_ebr_revenue_qtd_2w_prior,
        SUM(l14d_product_resilient_rec_rev_prior) l14d_product_resilient_rec_rev_prior,
        SUM(l14d_ebr_usd_rec_rev_prior) l14d_ebr_usd_rec_rev_prior,
        SUM(l14d_capi_ebr_revenue_prior) l14d_capi_ebr_revenue_prior,
        SUM(l14d_avg_product_resilient_rec_rev_prior) l14d_avg_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ebr_usd_rec_rev_prior) l14d_avg_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_capi_ebr_revenue_prior) l14d_avg_capi_ebr_revenue_prior,
        SUM(l14d_avg_ly_product_resilient_rec_rev_prior) l14d_avg_ly_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ly_ebr_usd_rec_rev_prior) l14d_avg_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_ly_capi_ebr_revenue_prior) l14d_avg_ly_capi_ebr_revenue_prior,
        SUM(l14d_ly_product_resilient_rec_rev_prior) l14d_ly_product_resilient_rec_rev_prior,
        SUM(l14d_ly_ebr_usd_rec_rev_prior) l14d_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_ly_capi_ebr_revenue_prior) l14d_ly_capi_ebr_revenue_prior,
        SUM(L14d_revenue) l14d_revenue,
        SUM(L14d_revenue_prior) l14d_revenue_prior,
        SUM(L14d_avg_revenue) l14d_avg_revenue,
        revenue_segment,
        'CP|AP Overlap' route_to_market
from

bpo_gms_quota_and_forecast_fast

where
(cp_username is not null and ap_username is not null)


group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,revenue_segment

    """,
)

bpo_gms_quota_and_forecast_rtm_am_pm_overlap = PrestoInsertOperatorWithSchema(
    dep_list=[bpo_gms_quota_and_forecast_rtm_reporting],
    table="<TABLE:bpo_gms_quota_and_forecast_rtm_fast>",
    partition="ds=<DATEID>/route_to_market=AM|PM Overlap",
    documentation={
        "description": """Creates a Subpartition for AM|PM Overlap on Route to Market"""
    },
    create=Table(
        cols=[
            Column('ultimate_client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('ultimate_client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('program', 'VARCHAR','', HiveAnon.NONE),
            Column('vertical', 'VARCHAR','', HiveAnon.NONE),
            Column('segmentation', 'VARCHAR','', HiveAnon.NONE),
            Column('asofdate', 'VARCHAR','', HiveAnon.NONE),
            Column('quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('next_quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('days_left_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_left_in_quarter_prior', 'BIGINT','', HiveAnon.NONE),
            Column('days_total_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_closed_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('l12_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l4_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l2_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_subregion', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_region', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_market', 'VARCHAR','', HiveAnon.NONE),
            Column('country', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('run_rate_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('quota', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('employee_type_1', 'VARCHAR','', HiveAnon.NONE),
            Column('employee_type_2', 'VARCHAR','', HiveAnon.NONE),
            Column('l12_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('revenue_segment', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_product_resilient_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_ebr_usd_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_capi_ebr_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
        ],
        partitions=[
            Column('ds', 'VARCHAR', 'datestamp'),
            Column('route_to_market', 'VARCHAR', ''),
        ],
        retention=15,
    ),
    select=r"""
        Select
        ultimate_parent_fbid ultimate_client_fbid ,
        ultimate_parent_name ultimate_client_name ,
        advertiser_name client_name ,
        advertiser_fbid client_fbid ,
        program ,
        advertiser_vertical vertical ,
        segmentation ,
        asofdate ,
        quarter_id ,
        next_quarter_id ,
        days_left_in_quarter ,
        days_left_in_quarter_prior ,
        days_total_in_quarter ,
        days_closed_in_quarter ,
        l12_reporting_territory l12_territory ,
        l10_reporting_territory l10_territory ,
        l8_reporting_territory l8_territory  ,
        l6_reporting_territory l6_territory  ,
        l4_reporting_territory l4_territory  ,
        l2_reporting_territory l2_territory  ,
        sales_adv_subregion fb_subregion ,
        sales_adv_region fb_region ,
        market fb_market ,
        advertiser_country country ,
        am_username employee_type_1,
        pm_username employee_type_2,
        l12_manager_agency_territory l12_territory_mgr,
        l10_manager_agency_territory l10_territory_mgr,
        l8_manager_agency_territory l8_territory_mgr,
        l6_manager_agency_territory l6_territory_mgr,
        SUM(run_rate_forecast) run_rate_forecast,
        SUM(run_rate_forecast_prior) run_rate_forecast_prior,
        SUM(advertiser_quota) quota,
        SUM(sales_forecast) sales_forecast,
        SUM(sales_forecast_prior) sales_forecast_prior,
        SUM(cq_revenue) cq_revenue,
        SUM(pq_revenue) pq_revenue,
        SUM(cq_revenue_qtd_prior) cq_revenue_qtd_prior,
        SUM(lyq_revenue) lyq_revenue,
        SUM(l2yq_revenue) l2yq_revenue,
        SUM(lyq_revenue_qtd) lyq_revenue_qtd,
        SUM(l2yq_revenue_qtd) l2yq_revenue_qtd,
        SUM(lyq_revenue_qtd_prior) lyq_revenue_qtd_prior,
        SUM(l2yq_revenue_qtd_prior) l2yq_revenue_qtd_prior,
        SUM(pq_revenue_qtd) pq_revenue_qtd,
        SUM(l7d_revenue) l7d_revenue,
        SUM(l7d_revenue_prior) l7d_revenue_prior,
        SUM(l7d_avg_revenue) l7d_avg_revenue,
        SUM(l7d_avg_revenue_prior) l7d_avg_revenue_prior,
        SUM(l7d_avg_ly_revenue) l7d_avg_ly_revenue,
        SUM(l7d_avg_ly_revenue_prior) l7d_avg_ly_revenue_prior,
        SUM(l7d_ly_revenue) l7d_ly_revenue,
        SUM(l7d_ly_revenue_prior) l7d_ly_revenue_prior,
        SUM(run_rate_forecast_2w_prior) run_rate_forecast_2w_prior,
        SUM(cq_revenue_qtd_2w_prior) cq_revenue_qtd_2w_prior,
        SUM(lyq_revenue_qtd_2w_prior) lyq_revenue_qtd_2w_prior,
        SUM(l2yq_revenue_qtd_2w_prior) l2yq_revenue_qtd_2w_prior,
        SUM(l14d_avg_revenue_prior) l14d_avg_revenue_prior,
        SUM(cq_optimal_qtd_2w_prior) cq_optimal_qtd_2w_prior,
        SUM(lyq_optimal_qtd_2w_prior) lyq_optimal_qtd_2w_prior,
        SUM(l14d_optimal_prior) l14d_optimal_prior,
        SUM(l14d_avg_optimal_prior) l14d_avg_optimal_prior,
        SUM(l14d_avg_ly_optimal_prior) l14d_avg_ly_optimal_prior,
        SUM(l14d_ly_optimal_prior) l14d_ly_optimal_prior,
        SUM(cq_dr_resilient_qtd_2w_prior) cq_dr_resilient_qtd_2w_prior,
        SUM(lyq_dr_resilient_qtd_2w_prior) lyq_dr_resilient_qtd_2w_prior,
        SUM(l14d_dr_resilient_prior) l14d_dr_resilient_prior,
        SUM(l14d_avg_dr_resilient_prior) l14d_avg_dr_resilient_prior,
        SUM(l14d_avg_ly_dr_resilient_prior) l14d_avg_ly_dr_resilient_prior,
        SUM(l14d_ly_dr_resilient_prior) l14d_ly_dr_resilient_prior,
        SUM(cq_product_resilient_rec_rev_qtd_2w_prior) cq_product_resilient_rec_rev_qtd_2w_prior,
        SUM(cq_ebr_usd_rec_rev_qtd_2w_prior) cq_ebr_usd_rec_rev_qtd_2w_prior,
        SUM(cq_capi_ebr_revenue_qtd_2w_prior) cq_capi_ebr_revenue_qtd_2w_prior,
        SUM(l14d_product_resilient_rec_rev_prior) l14d_product_resilient_rec_rev_prior,
        SUM(l14d_ebr_usd_rec_rev_prior) l14d_ebr_usd_rec_rev_prior,
        SUM(l14d_capi_ebr_revenue_prior) l14d_capi_ebr_revenue_prior,
        SUM(l14d_avg_product_resilient_rec_rev_prior) l14d_avg_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ebr_usd_rec_rev_prior) l14d_avg_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_capi_ebr_revenue_prior) l14d_avg_capi_ebr_revenue_prior,
        SUM(l14d_avg_ly_product_resilient_rec_rev_prior) l14d_avg_ly_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ly_ebr_usd_rec_rev_prior) l14d_avg_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_ly_capi_ebr_revenue_prior) l14d_avg_ly_capi_ebr_revenue_prior,
        SUM(l14d_ly_product_resilient_rec_rev_prior) l14d_ly_product_resilient_rec_rev_prior,
        SUM(l14d_ly_ebr_usd_rec_rev_prior) l14d_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_ly_capi_ebr_revenue_prior) l14d_ly_capi_ebr_revenue_prior,
        SUM(L14d_revenue) l14d_revenue,
        SUM(L14d_revenue_prior) l14d_revenue_prior,
        SUM(L14d_avg_revenue) l14d_avg_revenue,
        revenue_segment,
        'AM|PM Overlap' route_to_market
from

bpo_gms_quota_and_forecast_fast

where

(am_username is not null and pm_username is not null)


group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,revenue_segment

    """,
)

bpo_gms_quota_and_forecast_rtm_cp_pm_overlap = PrestoInsertOperatorWithSchema(
    dep_list=[bpo_gms_quota_and_forecast_rtm_reporting],
    table="<TABLE:bpo_gms_quota_and_forecast_rtm_fast>",
    partition="ds=<DATEID>/route_to_market=CP|PM Overlap",
    documentation={
        "description": """Creates a Subpartition for CP|PM Overlap on Route to Market"""
    },
    create=Table(
        cols=[
            Column('ultimate_client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('ultimate_client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('program', 'VARCHAR','', HiveAnon.NONE),
            Column('vertical', 'VARCHAR','', HiveAnon.NONE),
            Column('segmentation', 'VARCHAR','', HiveAnon.NONE),
            Column('asofdate', 'VARCHAR','', HiveAnon.NONE),
            Column('quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('next_quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('days_left_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_left_in_quarter_prior', 'BIGINT','', HiveAnon.NONE),
            Column('days_total_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_closed_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('l12_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l4_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l2_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_subregion', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_region', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_market', 'VARCHAR','', HiveAnon.NONE),
            Column('country', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('run_rate_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('quota', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('employee_type_1', 'VARCHAR','', HiveAnon.NONE),
            Column('employee_type_2', 'VARCHAR','', HiveAnon.NONE),
            Column('l12_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('revenue_segment', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_product_resilient_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_ebr_usd_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_capi_ebr_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
        ],
        partitions=[
            Column('ds', 'VARCHAR', 'datestamp'),
            Column('route_to_market', 'VARCHAR', ''),
        ],
        retention=15,
    ),
    select=r"""
        Select
        ultimate_parent_fbid ultimate_client_fbid ,
        ultimate_parent_name ultimate_client_name ,
        advertiser_name client_name ,
        advertiser_fbid client_fbid ,
        program ,
        advertiser_vertical vertical ,
        segmentation ,
        asofdate ,
        quarter_id ,
        next_quarter_id ,
        days_left_in_quarter ,
        days_left_in_quarter_prior ,
        days_total_in_quarter ,
        days_closed_in_quarter ,
        l12_reporting_territory l12_territory ,
        l10_reporting_territory l10_territory ,
        l8_reporting_territory l8_territory  ,
        l6_reporting_territory l6_territory  ,
        l4_reporting_territory l4_territory  ,
        l2_reporting_territory l2_territory  ,
        sales_adv_subregion fb_subregion ,
        sales_adv_region fb_region ,
        market fb_market ,
        advertiser_country country ,
        cp_username employee_type_1,
        pm_username employee_type_2,
        l12_reporting_terr_mgr l12_territory_mgr,
        l10_reporting_terr_mgr l10_territory_mgr,
        l8_reporting_terr_mgr l8_territory_mgr,
        l6_reporting_terr_mgr l6_territory_mgr,
        SUM(run_rate_forecast) run_rate_forecast,
        SUM(run_rate_forecast_prior) run_rate_forecast_prior,
        SUM(advertiser_quota) quota,
        SUM(sales_forecast) sales_forecast,
        SUM(sales_forecast_prior) sales_forecast_prior,
        SUM(cq_revenue) cq_revenue,
        SUM(pq_revenue) pq_revenue,
        SUM(cq_revenue_qtd_prior) cq_revenue_qtd_prior,
        SUM(lyq_revenue) lyq_revenue,
        SUM(l2yq_revenue) l2yq_revenue,
        SUM(lyq_revenue_qtd) lyq_revenue_qtd,
        SUM(l2yq_revenue_qtd) l2yq_revenue_qtd,
        SUM(lyq_revenue_qtd_prior) lyq_revenue_qtd_prior,
        SUM(l2yq_revenue_qtd_prior) l2yq_revenue_qtd_prior,
        SUM(pq_revenue_qtd) pq_revenue_qtd,
        SUM(l7d_revenue) l7d_revenue,
        SUM(l7d_revenue_prior) l7d_revenue_prior,
        SUM(l7d_avg_revenue) l7d_avg_revenue,
        SUM(l7d_avg_revenue_prior) l7d_avg_revenue_prior,
        SUM(l7d_avg_ly_revenue) l7d_avg_ly_revenue,
        SUM(l7d_avg_ly_revenue_prior) l7d_avg_ly_revenue_prior,
        SUM(l7d_ly_revenue) l7d_ly_revenue,
        SUM(l7d_ly_revenue_prior) l7d_ly_revenue_prior,
        SUM(run_rate_forecast_2w_prior) run_rate_forecast_2w_prior,
        SUM(cq_revenue_qtd_2w_prior) cq_revenue_qtd_2w_prior,
        SUM(lyq_revenue_qtd_2w_prior) lyq_revenue_qtd_2w_prior,
        SUM(l2yq_revenue_qtd_2w_prior) l2yq_revenue_qtd_2w_prior,
        SUM(l14d_avg_revenue_prior) l14d_avg_revenue_prior,
        SUM(cq_optimal_qtd_2w_prior) cq_optimal_qtd_2w_prior,
        SUM(lyq_optimal_qtd_2w_prior) lyq_optimal_qtd_2w_prior,
        SUM(l14d_optimal_prior) l14d_optimal_prior,
        SUM(l14d_avg_optimal_prior) l14d_avg_optimal_prior,
        SUM(l14d_avg_ly_optimal_prior) l14d_avg_ly_optimal_prior,
        SUM(l14d_ly_optimal_prior) l14d_ly_optimal_prior,
        SUM(cq_dr_resilient_qtd_2w_prior) cq_dr_resilient_qtd_2w_prior,
        SUM(lyq_dr_resilient_qtd_2w_prior) lyq_dr_resilient_qtd_2w_prior,
        SUM(l14d_dr_resilient_prior) l14d_dr_resilient_prior,
        SUM(l14d_avg_dr_resilient_prior) l14d_avg_dr_resilient_prior,
        SUM(l14d_avg_ly_dr_resilient_prior) l14d_avg_ly_dr_resilient_prior,
        SUM(l14d_ly_dr_resilient_prior) l14d_ly_dr_resilient_prior,
        SUM(cq_product_resilient_rec_rev_qtd_2w_prior) cq_product_resilient_rec_rev_qtd_2w_prior,
        SUM(cq_ebr_usd_rec_rev_qtd_2w_prior) cq_ebr_usd_rec_rev_qtd_2w_prior,
        SUM(cq_capi_ebr_revenue_qtd_2w_prior) cq_capi_ebr_revenue_qtd_2w_prior,
        SUM(l14d_product_resilient_rec_rev_prior) l14d_product_resilient_rec_rev_prior,
        SUM(l14d_ebr_usd_rec_rev_prior) l14d_ebr_usd_rec_rev_prior,
        SUM(l14d_capi_ebr_revenue_prior) l14d_capi_ebr_revenue_prior,
        SUM(l14d_avg_product_resilient_rec_rev_prior) l14d_avg_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ebr_usd_rec_rev_prior) l14d_avg_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_capi_ebr_revenue_prior) l14d_avg_capi_ebr_revenue_prior,
        SUM(l14d_avg_ly_product_resilient_rec_rev_prior) l14d_avg_ly_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ly_ebr_usd_rec_rev_prior) l14d_avg_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_ly_capi_ebr_revenue_prior) l14d_avg_ly_capi_ebr_revenue_prior,
        SUM(l14d_ly_product_resilient_rec_rev_prior) l14d_ly_product_resilient_rec_rev_prior,
        SUM(l14d_ly_ebr_usd_rec_rev_prior) l14d_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_ly_capi_ebr_revenue_prior) l14d_ly_capi_ebr_revenue_prior,
        SUM(L14d_revenue) l14d_revenue,
        SUM(L14d_revenue_prior) l14d_revenue_prior,
        SUM(L14d_avg_revenue) l14d_avg_revenue,
        revenue_segment,
        'CP|PM Overlap' route_to_market
from

bpo_gms_quota_and_forecast_fast

where

(pm_username is not null and cp_username is not null)


group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,revenue_segment

    """,
)

bpo_gms_quota_and_forecast_rtm_cp_am_overlap = PrestoInsertOperatorWithSchema(
    dep_list=[bpo_gms_quota_and_forecast_rtm_reporting],
    table="<TABLE:bpo_gms_quota_and_forecast_rtm_fast>",
    partition="ds=<DATEID>/route_to_market=CP|AM Overlap",
    documentation={
        "description": """Creates a Subpartition for CP|AM Overlap on Route to Market"""
    },
    create=Table(
        cols=[
            Column('ultimate_client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('ultimate_client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('program', 'VARCHAR','', HiveAnon.NONE),
            Column('vertical', 'VARCHAR','', HiveAnon.NONE),
            Column('segmentation', 'VARCHAR','', HiveAnon.NONE),
            Column('asofdate', 'VARCHAR','', HiveAnon.NONE),
            Column('quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('next_quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('days_left_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_left_in_quarter_prior', 'BIGINT','', HiveAnon.NONE),
            Column('days_total_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_closed_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('l12_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l4_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l2_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_subregion', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_region', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_market', 'VARCHAR','', HiveAnon.NONE),
            Column('country', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('run_rate_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('quota', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('employee_type_1', 'VARCHAR','', HiveAnon.NONE),
            Column('employee_type_2', 'VARCHAR','', HiveAnon.NONE),
            Column('l12_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('revenue_segment', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_product_resilient_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_ebr_usd_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_capi_ebr_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
        ],
        partitions=[
            Column('ds', 'VARCHAR', 'datestamp'),
            Column('route_to_market', 'VARCHAR', ''),
        ],
        retention=15,
    ),
    select=r"""
        Select
        ultimate_parent_fbid ultimate_client_fbid ,
        ultimate_parent_name ultimate_client_name ,
        advertiser_name client_name ,
        advertiser_fbid client_fbid ,
        program ,
        advertiser_vertical vertical ,
        segmentation ,
        asofdate ,
        quarter_id ,
        next_quarter_id ,
        days_left_in_quarter ,
        days_left_in_quarter_prior ,
        days_total_in_quarter ,
        days_closed_in_quarter ,
        l12_reporting_territory l12_territory ,
        l10_reporting_territory l10_territory ,
        l8_reporting_territory l8_territory  ,
        l6_reporting_territory l6_territory  ,
        l4_reporting_territory l4_territory  ,
        l2_reporting_territory l2_territory  ,
        sales_adv_subregion fb_subregion ,
        sales_adv_region fb_region ,
        market fb_market ,
        advertiser_country country ,
         cp_username employee_type_1,
        am_username employee_type_2,
        l12_reporting_terr_mgr l12_territory_mgr,
        l10_reporting_terr_mgr l10_territory_mgr,
        l8_reporting_terr_mgr l8_territory_mgr,
        l6_reporting_terr_mgr l6_territory_mgr,
        SUM(run_rate_forecast) run_rate_forecast,
        SUM(run_rate_forecast_prior) run_rate_forecast_prior,
        SUM(advertiser_quota) quota,
        SUM(sales_forecast) sales_forecast,
        SUM(sales_forecast_prior) sales_forecast_prior,
        SUM(cq_revenue) cq_revenue,
        SUM(pq_revenue) pq_revenue,
        SUM(cq_revenue_qtd_prior) cq_revenue_qtd_prior,
        SUM(lyq_revenue) lyq_revenue,
        SUM(l2yq_revenue) l2yq_revenue,
        SUM(lyq_revenue_qtd) lyq_revenue_qtd,
        SUM(l2yq_revenue_qtd) l2yq_revenue_qtd,
        SUM(lyq_revenue_qtd_prior) lyq_revenue_qtd_prior,
        SUM(l2yq_revenue_qtd_prior) l2yq_revenue_qtd_prior,
        SUM(pq_revenue_qtd) pq_revenue_qtd,
        SUM(l7d_revenue) l7d_revenue,
        SUM(l7d_revenue_prior) l7d_revenue_prior,
        SUM(l7d_avg_revenue) l7d_avg_revenue,
        SUM(l7d_avg_revenue_prior) l7d_avg_revenue_prior,
        SUM(l7d_avg_ly_revenue) l7d_avg_ly_revenue,
        SUM(l7d_avg_ly_revenue_prior) l7d_avg_ly_revenue_prior,
        SUM(l7d_ly_revenue) l7d_ly_revenue,
        SUM(l7d_ly_revenue_prior) l7d_ly_revenue_prior,
        SUM(run_rate_forecast_2w_prior) run_rate_forecast_2w_prior,
        SUM(cq_revenue_qtd_2w_prior) cq_revenue_qtd_2w_prior,
        SUM(lyq_revenue_qtd_2w_prior) lyq_revenue_qtd_2w_prior,
        SUM(l2yq_revenue_qtd_2w_prior) l2yq_revenue_qtd_2w_prior,
        SUM(l14d_avg_revenue_prior) l14d_avg_revenue_prior,
        SUM(cq_optimal_qtd_2w_prior) cq_optimal_qtd_2w_prior,
        SUM(lyq_optimal_qtd_2w_prior) lyq_optimal_qtd_2w_prior,
        SUM(l14d_optimal_prior) l14d_optimal_prior,
        SUM(l14d_avg_optimal_prior) l14d_avg_optimal_prior,
        SUM(l14d_avg_ly_optimal_prior) l14d_avg_ly_optimal_prior,
        SUM(l14d_ly_optimal_prior) l14d_ly_optimal_prior,
        SUM(cq_dr_resilient_qtd_2w_prior) cq_dr_resilient_qtd_2w_prior,
        SUM(lyq_dr_resilient_qtd_2w_prior) lyq_dr_resilient_qtd_2w_prior,
        SUM(l14d_dr_resilient_prior) l14d_dr_resilient_prior,
        SUM(l14d_avg_dr_resilient_prior) l14d_avg_dr_resilient_prior,
        SUM(l14d_avg_ly_dr_resilient_prior) l14d_avg_ly_dr_resilient_prior,
        SUM(l14d_ly_dr_resilient_prior) l14d_ly_dr_resilient_prior,
        SUM(cq_product_resilient_rec_rev_qtd_2w_prior) cq_product_resilient_rec_rev_qtd_2w_prior,
        SUM(cq_ebr_usd_rec_rev_qtd_2w_prior) cq_ebr_usd_rec_rev_qtd_2w_prior,
        SUM(cq_capi_ebr_revenue_qtd_2w_prior) cq_capi_ebr_revenue_qtd_2w_prior,
        SUM(l14d_product_resilient_rec_rev_prior) l14d_product_resilient_rec_rev_prior,
        SUM(l14d_ebr_usd_rec_rev_prior) l14d_ebr_usd_rec_rev_prior,
        SUM(l14d_capi_ebr_revenue_prior) l14d_capi_ebr_revenue_prior,
        SUM(l14d_avg_product_resilient_rec_rev_prior) l14d_avg_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ebr_usd_rec_rev_prior) l14d_avg_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_capi_ebr_revenue_prior) l14d_avg_capi_ebr_revenue_prior,
        SUM(l14d_avg_ly_product_resilient_rec_rev_prior) l14d_avg_ly_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ly_ebr_usd_rec_rev_prior) l14d_avg_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_ly_capi_ebr_revenue_prior) l14d_avg_ly_capi_ebr_revenue_prior,
        SUM(l14d_ly_product_resilient_rec_rev_prior) l14d_ly_product_resilient_rec_rev_prior,
        SUM(l14d_ly_ebr_usd_rec_rev_prior) l14d_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_ly_capi_ebr_revenue_prior) l14d_ly_capi_ebr_revenue_prior,
        SUM(L14d_revenue) l14d_revenue,
        SUM(L14d_revenue_prior) l14d_revenue_prior,
        SUM(L14d_avg_revenue) l14d_avg_revenue,
        revenue_segment,
        'CP|AM Overlap' route_to_market
from

bpo_gms_quota_and_forecast_fast

where

(am_username is not null and cp_username is not null)


group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,revenue_segment

    """,
)

bpo_gms_quota_and_forecast_rtm_ap_pm_overlap = PrestoInsertOperatorWithSchema(
    dep_list=[bpo_gms_quota_and_forecast_rtm_reporting],
    table="<TABLE:bpo_gms_quota_and_forecast_rtm_fast>",
    partition="ds=<DATEID>/route_to_market=AP|PM Overlap",
    documentation={
        "description": """Creates a Subpartition for AP|PM Overlap on Route to Market"""
    },
    create=Table(
        cols=[
            Column('ultimate_client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('ultimate_client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('program', 'VARCHAR','', HiveAnon.NONE),
            Column('vertical', 'VARCHAR','', HiveAnon.NONE),
            Column('segmentation', 'VARCHAR','', HiveAnon.NONE),
            Column('asofdate', 'VARCHAR','', HiveAnon.NONE),
            Column('quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('next_quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('days_left_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_left_in_quarter_prior', 'BIGINT','', HiveAnon.NONE),
            Column('days_total_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_closed_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('l12_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l4_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l2_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_subregion', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_region', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_market', 'VARCHAR','', HiveAnon.NONE),
            Column('country', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('run_rate_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('quota', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('employee_type_1', 'VARCHAR','', HiveAnon.NONE),
            Column('employee_type_2', 'VARCHAR','', HiveAnon.NONE),
            Column('l12_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('revenue_segment', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_product_resilient_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_ebr_usd_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_capi_ebr_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
        ],
        partitions=[
            Column('ds', 'VARCHAR', 'datestamp'),
            Column('route_to_market', 'VARCHAR', ''),
        ],
        retention=15,
    ),
    select=r"""
        Select
        planning_agency_ult_fbid ultimate_client_fbid ,
        planning_agency_ult_name ultimate_client_name ,
        planning_agency_name client_name ,
        planning_agency_fbid client_fbid ,
        program_agency program,
        'Not Available' vertical ,
        'Not Available' segmentation ,
        asofdate ,
        quarter_id ,
        next_quarter_id ,
        days_left_in_quarter ,
        days_left_in_quarter_prior ,
        days_total_in_quarter ,
        days_closed_in_quarter ,
        l12_agency_territory l12_territory ,
        l10_agency_territory l10_territory ,
        l8_agency_territory l8_territory  ,
        l6_agency_territory l6_territory  ,
        l4_agency_territory l4_territory  ,
        l2_agency_territory l2_territory  ,
        sub_region_agc fb_subregion ,
        region_agc fb_region ,
        market_agc fb_market ,
        country_agc country ,
        ap_username employee_type_1,
        pm_username employee_type_2,
        l12_manager_agency_territory l12_territory_mgr,
        l10_manager_agency_territory l10_territory_mgr,
        l8_manager_agency_territory l8_territory_mgr,
        l6_manager_agency_territory l6_territory_mgr,
        SUM(run_rate_forecast) run_rate_forecast,
        SUM(run_rate_forecast_prior) run_rate_forecast_prior,
        SUM(agency_quota) quota,
        null sales_forecast,
        null sales_forecast_prior,
        SUM(cq_revenue) cq_revenue,
        SUM(pq_revenue) pq_revenue,
        SUM(cq_revenue_qtd_prior) cq_revenue_qtd_prior,
        SUM(lyq_revenue) lyq_revenue,
        SUM(l2yq_revenue) l2yq_revenue,
        SUM(lyq_revenue_qtd) lyq_revenue_qtd,
        SUM(l2yq_revenue_qtd) l2yq_revenue_qtd,
        SUM(lyq_revenue_qtd_prior) lyq_revenue_qtd_prior,
        SUM(l2yq_revenue_qtd_prior) l2yq_revenue_qtd_prior,
        SUM(pq_revenue_qtd) pq_revenue_qtd,
        SUM(l7d_revenue) l7d_revenue,
        SUM(l7d_revenue_prior) l7d_revenue_prior,
        SUM(l7d_avg_revenue) l7d_avg_revenue,
        SUM(l7d_avg_revenue_prior) l7d_avg_revenue_prior,
        SUM(l7d_avg_ly_revenue) l7d_avg_ly_revenue,
        SUM(l7d_avg_ly_revenue_prior) l7d_avg_ly_revenue_prior,
        SUM(l7d_ly_revenue) l7d_ly_revenue,
        SUM(l7d_ly_revenue_prior) l7d_ly_revenue_prior,
        SUM(run_rate_forecast_2w_prior) run_rate_forecast_2w_prior,
        SUM(cq_revenue_qtd_2w_prior) cq_revenue_qtd_2w_prior,
        SUM(lyq_revenue_qtd_2w_prior) lyq_revenue_qtd_2w_prior,
        SUM(l2yq_revenue_qtd_2w_prior) l2yq_revenue_qtd_2w_prior,
        SUM(l14d_avg_revenue_prior) l14d_avg_revenue_prior,
        SUM(cq_optimal_qtd_2w_prior) cq_optimal_qtd_2w_prior,
        SUM(lyq_optimal_qtd_2w_prior) lyq_optimal_qtd_2w_prior,
        SUM(l14d_optimal_prior) l14d_optimal_prior,
        SUM(l14d_avg_optimal_prior) l14d_avg_optimal_prior,
        SUM(l14d_avg_ly_optimal_prior) l14d_avg_ly_optimal_prior,
        SUM(l14d_ly_optimal_prior) l14d_ly_optimal_prior,
        SUM(cq_dr_resilient_qtd_2w_prior) cq_dr_resilient_qtd_2w_prior,
        SUM(lyq_dr_resilient_qtd_2w_prior) lyq_dr_resilient_qtd_2w_prior,
        SUM(l14d_dr_resilient_prior) l14d_dr_resilient_prior,
        SUM(l14d_avg_dr_resilient_prior) l14d_avg_dr_resilient_prior,
        SUM(l14d_avg_ly_dr_resilient_prior) l14d_avg_ly_dr_resilient_prior,
        SUM(l14d_ly_dr_resilient_prior) l14d_ly_dr_resilient_prior,
        SUM(cq_product_resilient_rec_rev_qtd_2w_prior) cq_product_resilient_rec_rev_qtd_2w_prior,
        SUM(cq_ebr_usd_rec_rev_qtd_2w_prior) cq_ebr_usd_rec_rev_qtd_2w_prior,
        SUM(cq_capi_ebr_revenue_qtd_2w_prior) cq_capi_ebr_revenue_qtd_2w_prior,
        SUM(l14d_product_resilient_rec_rev_prior) l14d_product_resilient_rec_rev_prior,
        SUM(l14d_ebr_usd_rec_rev_prior) l14d_ebr_usd_rec_rev_prior,
        SUM(l14d_capi_ebr_revenue_prior) l14d_capi_ebr_revenue_prior,
        SUM(l14d_avg_product_resilient_rec_rev_prior) l14d_avg_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ebr_usd_rec_rev_prior) l14d_avg_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_capi_ebr_revenue_prior) l14d_avg_capi_ebr_revenue_prior,
        SUM(l14d_avg_ly_product_resilient_rec_rev_prior) l14d_avg_ly_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ly_ebr_usd_rec_rev_prior) l14d_avg_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_ly_capi_ebr_revenue_prior) l14d_avg_ly_capi_ebr_revenue_prior,
        SUM(l14d_ly_product_resilient_rec_rev_prior) l14d_ly_product_resilient_rec_rev_prior,
        SUM(l14d_ly_ebr_usd_rec_rev_prior) l14d_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_ly_capi_ebr_revenue_prior) l14d_ly_capi_ebr_revenue_prior,
        SUM(L14d_revenue) l14d_revenue,
        SUM(L14d_revenue_prior) l14d_revenue_prior,
        SUM(L14d_avg_revenue) l14d_avg_revenue,
        'AP|PM Overlap' route_to_market,
        program_agency revenue_segment
from

bpo_gms_quota_and_forecast_fast

where

(ap_username is not null and pm_username is not null)

group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,revenue_segment

    """,
)

bpo_gms_quota_and_forecast_rtm_am_ap_overlap = PrestoInsertOperatorWithSchema(
    dep_list=[bpo_gms_quota_and_forecast_rtm_reporting],
    table="<TABLE:bpo_gms_quota_and_forecast_rtm_fast>",
    partition="ds=<DATEID>/route_to_market=AM|AP Overlap",
    documentation={
        "description": """Creates a Subpartition for AM/AP Overlap on Route to Market"""
    },
    create=Table(
        cols=[
            Column('ultimate_client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('ultimate_client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('program', 'VARCHAR','', HiveAnon.NONE),
            Column('vertical', 'VARCHAR','', HiveAnon.NONE),
            Column('segmentation', 'VARCHAR','', HiveAnon.NONE),
            Column('asofdate', 'VARCHAR','', HiveAnon.NONE),
            Column('quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('next_quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('days_left_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_left_in_quarter_prior', 'BIGINT','', HiveAnon.NONE),
            Column('days_total_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_closed_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('l12_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l4_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l2_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_subregion', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_region', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_market', 'VARCHAR','', HiveAnon.NONE),
            Column('country', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('run_rate_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('quota', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('employee_type_1', 'VARCHAR','', HiveAnon.NONE),
            Column('employee_type_2', 'VARCHAR','', HiveAnon.NONE),
            Column('l12_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('revenue_segment', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_product_resilient_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_ebr_usd_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_capi_ebr_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
        ],
        partitions=[
            Column('ds', 'VARCHAR', 'datestamp'),
            Column('route_to_market', 'VARCHAR', ''),
        ],
        retention=15,
    ),
    select=r"""
        Select
        ultimate_parent_fbid ultimate_client_fbid ,
        ultimate_parent_name ultimate_client_name ,
        advertiser_name client_name ,
        advertiser_fbid client_fbid ,
        program ,
        advertiser_vertical vertical ,
        segmentation ,
        asofdate ,
        quarter_id ,
        next_quarter_id ,
        days_left_in_quarter ,
        days_left_in_quarter_prior ,
        days_total_in_quarter ,
        days_closed_in_quarter ,
        l12_reporting_territory l12_territory ,
        l10_reporting_territory l10_territory ,
        l8_reporting_territory l8_territory  ,
        l6_reporting_territory l6_territory  ,
        l4_reporting_territory l4_territory  ,
        l2_reporting_territory l2_territory  ,
        sales_adv_subregion fb_subregion ,
        sales_adv_region fb_region ,
        market fb_market ,
        advertiser_country country ,
        NULL employee_type_1,
        NULL employee_type_2,
        NULL l12_territory_mgr,
        NULL l10_territory_mgr,
        NULL l8_territory_mgr,
        NULL l6_territory_mgr,
        SUM(run_rate_forecast) run_rate_forecast,
        SUM(run_rate_forecast_prior) run_rate_forecast_prior,
        SUM(advertiser_quota) quota,
        SUM(sales_forecast) sales_forecast,
        SUM(sales_forecast_prior) sales_forecast_prior,
        SUM(cq_revenue) cq_revenue,
        SUM(pq_revenue) pq_revenue,
        SUM(cq_revenue_qtd_prior) cq_revenue_qtd_prior,
        SUM(lyq_revenue) lyq_revenue,
        SUM(l2yq_revenue) l2yq_revenue,
        SUM(lyq_revenue_qtd) lyq_revenue_qtd,
        SUM(l2yq_revenue_qtd) l2yq_revenue_qtd,
        SUM(lyq_revenue_qtd_prior) lyq_revenue_qtd_prior,
        SUM(l2yq_revenue_qtd_prior) l2yq_revenue_qtd_prior,
        SUM(pq_revenue_qtd) pq_revenue_qtd,
        SUM(l7d_revenue) l7d_revenue,
        SUM(l7d_revenue_prior) l7d_revenue_prior,
        SUM(l7d_avg_revenue) l7d_avg_revenue,
        SUM(l7d_avg_revenue_prior) l7d_avg_revenue_prior,
        SUM(l7d_avg_ly_revenue) l7d_avg_ly_revenue,
        SUM(l7d_avg_ly_revenue_prior) l7d_avg_ly_revenue_prior,
        SUM(l7d_ly_revenue) l7d_ly_revenue,
        SUM(l7d_ly_revenue_prior) l7d_ly_revenue_prior,
        SUM(run_rate_forecast_2w_prior) run_rate_forecast_2w_prior,
        SUM(cq_revenue_qtd_2w_prior) cq_revenue_qtd_2w_prior,
        SUM(lyq_revenue_qtd_2w_prior) lyq_revenue_qtd_2w_prior,
        SUM(l2yq_revenue_qtd_2w_prior) l2yq_revenue_qtd_2w_prior,
        SUM(l14d_avg_revenue_prior) l14d_avg_revenue_prior,
        SUM(cq_optimal_qtd_2w_prior) cq_optimal_qtd_2w_prior,
        SUM(lyq_optimal_qtd_2w_prior) lyq_optimal_qtd_2w_prior,
        SUM(l14d_optimal_prior) l14d_optimal_prior,
        SUM(l14d_avg_optimal_prior) l14d_avg_optimal_prior,
        SUM(l14d_avg_ly_optimal_prior) l14d_avg_ly_optimal_prior,
        SUM(l14d_ly_optimal_prior) l14d_ly_optimal_prior,
        SUM(cq_dr_resilient_qtd_2w_prior) cq_dr_resilient_qtd_2w_prior,
        SUM(lyq_dr_resilient_qtd_2w_prior) lyq_dr_resilient_qtd_2w_prior,
        SUM(l14d_dr_resilient_prior) l14d_dr_resilient_prior,
        SUM(l14d_avg_dr_resilient_prior) l14d_avg_dr_resilient_prior,
        SUM(l14d_avg_ly_dr_resilient_prior) l14d_avg_ly_dr_resilient_prior,
        SUM(l14d_ly_dr_resilient_prior) l14d_ly_dr_resilient_prior,
        SUM(cq_product_resilient_rec_rev_qtd_2w_prior) cq_product_resilient_rec_rev_qtd_2w_prior,
        SUM(cq_ebr_usd_rec_rev_qtd_2w_prior) cq_ebr_usd_rec_rev_qtd_2w_prior,
        SUM(cq_capi_ebr_revenue_qtd_2w_prior) cq_capi_ebr_revenue_qtd_2w_prior,
        SUM(l14d_product_resilient_rec_rev_prior) l14d_product_resilient_rec_rev_prior,
        SUM(l14d_ebr_usd_rec_rev_prior) l14d_ebr_usd_rec_rev_prior,
        SUM(l14d_capi_ebr_revenue_prior) l14d_capi_ebr_revenue_prior,
        SUM(l14d_avg_product_resilient_rec_rev_prior) l14d_avg_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ebr_usd_rec_rev_prior) l14d_avg_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_capi_ebr_revenue_prior) l14d_avg_capi_ebr_revenue_prior,
        SUM(l14d_avg_ly_product_resilient_rec_rev_prior) l14d_avg_ly_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ly_ebr_usd_rec_rev_prior) l14d_avg_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_ly_capi_ebr_revenue_prior) l14d_avg_ly_capi_ebr_revenue_prior,
        SUM(l14d_ly_product_resilient_rec_rev_prior) l14d_ly_product_resilient_rec_rev_prior,
        SUM(l14d_ly_ebr_usd_rec_rev_prior) l14d_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_ly_capi_ebr_revenue_prior) l14d_ly_capi_ebr_revenue_prior,
        SUM(L14d_revenue) l14d_revenue,
        SUM(L14d_revenue_prior) l14d_revenue_prior,
        SUM(L14d_avg_revenue) l14d_avg_revenue,
        revenue_segment,
        'AM|AP Overlap' route_to_market
from

bpo_gms_quota_and_forecast_fast

where

(ap_username is not null and am_username is not null)


group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24, revenue_segment

    """,
)

bpo_gms_quota_and_forecast_rtm_cp_rp_overlap = PrestoInsertOperatorWithSchema(
    dep_list=[bpo_gms_quota_and_forecast_rtm_reporting],
    table="<TABLE:bpo_gms_quota_and_forecast_rtm_fast>",
    partition="ds=<DATEID>/route_to_market=CP|RP Overlap",
    documentation={
        "description": """Creates a Subpartition for CP|RP Overlap on Route to Market"""
    },
    create=Table(
        cols=[
            Column('ultimate_client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('ultimate_client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('program', 'VARCHAR','', HiveAnon.NONE),
            Column('vertical', 'VARCHAR','', HiveAnon.NONE),
            Column('segmentation', 'VARCHAR','', HiveAnon.NONE),
            Column('asofdate', 'VARCHAR','', HiveAnon.NONE),
            Column('quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('next_quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('days_left_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_left_in_quarter_prior', 'BIGINT','', HiveAnon.NONE),
            Column('days_total_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_closed_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('l12_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l4_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l2_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_subregion', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_region', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_market', 'VARCHAR','', HiveAnon.NONE),
            Column('country', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('run_rate_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('quota', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('employee_type_1', 'VARCHAR','', HiveAnon.NONE),
            Column('employee_type_2', 'VARCHAR','', HiveAnon.NONE),
            Column('l12_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('revenue_segment', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_product_resilient_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_ebr_usd_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_capi_ebr_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
        ],
        partitions=[
            Column('ds', 'VARCHAR', 'datestamp'),
            Column('route_to_market', 'VARCHAR', ''),
        ],
        retention=15,
    ),
    select=r"""
        Select
        ultimate_parent_fbid ultimate_client_fbid ,
        ultimate_parent_name ultimate_client_name ,
        advertiser_name client_name ,
        advertiser_fbid client_fbid ,
        program ,
        advertiser_vertical vertical ,
        segmentation ,
        asofdate ,
        quarter_id ,
        next_quarter_id ,
        days_left_in_quarter ,
        days_left_in_quarter_prior ,
        days_total_in_quarter ,
        days_closed_in_quarter ,
        l12_reporting_territory l12_territory ,
        l10_reporting_territory l10_territory ,
        l8_reporting_territory l8_territory  ,
        l6_reporting_territory l6_territory  ,
        l4_reporting_territory l4_territory  ,
        l2_reporting_territory l2_territory  ,
        sales_adv_subregion fb_subregion ,
        sales_adv_region fb_region ,
        market fb_market ,
        advertiser_country country ,
        NULL employee_type_1,
        NULL employee_type_2,
        NULL l12_territory_mgr,
        NULL l10_territory_mgr,
        NULL l8_territory_mgr,
        NULL l6_territory_mgr,
        SUM(run_rate_forecast) run_rate_forecast,
        SUM(run_rate_forecast_prior) run_rate_forecast_prior,
        SUM(advertiser_quota) quota,
        SUM(sales_forecast) sales_forecast,
        SUM(sales_forecast_prior) sales_forecast_prior,
        SUM(cq_revenue) cq_revenue,
        SUM(pq_revenue) pq_revenue,
        SUM(cq_revenue_qtd_prior) cq_revenue_qtd_prior,
        SUM(lyq_revenue) lyq_revenue,
        SUM(l2yq_revenue) l2yq_revenue,
        SUM(lyq_revenue_qtd) lyq_revenue_qtd,
        SUM(l2yq_revenue_qtd) l2yq_revenue_qtd,
        SUM(lyq_revenue_qtd_prior) lyq_revenue_qtd_prior,
        SUM(l2yq_revenue_qtd_prior) l2yq_revenue_qtd_prior,
        SUM(pq_revenue_qtd) pq_revenue_qtd,
        SUM(l7d_revenue) l7d_revenue,
        SUM(l7d_revenue_prior) l7d_revenue_prior,
        SUM(l7d_avg_revenue) l7d_avg_revenue,
        SUM(l7d_avg_revenue_prior) l7d_avg_revenue_prior,
        SUM(l7d_avg_ly_revenue) l7d_avg_ly_revenue,
        SUM(l7d_avg_ly_revenue_prior) l7d_avg_ly_revenue_prior,
        SUM(l7d_ly_revenue) l7d_ly_revenue,
        SUM(l7d_ly_revenue_prior) l7d_ly_revenue_prior,
        SUM(run_rate_forecast_2w_prior) run_rate_forecast_2w_prior,
        SUM(cq_revenue_qtd_2w_prior) cq_revenue_qtd_2w_prior,
        SUM(lyq_revenue_qtd_2w_prior) lyq_revenue_qtd_2w_prior,
        SUM(l2yq_revenue_qtd_2w_prior) l2yq_revenue_qtd_2w_prior,
        SUM(l14d_avg_revenue_prior) l14d_avg_revenue_prior,
        SUM(cq_optimal_qtd_2w_prior) cq_optimal_qtd_2w_prior,
        SUM(lyq_optimal_qtd_2w_prior) lyq_optimal_qtd_2w_prior,
        SUM(l14d_optimal_prior) l14d_optimal_prior,
        SUM(l14d_avg_optimal_prior) l14d_avg_optimal_prior,
        SUM(l14d_avg_ly_optimal_prior) l14d_avg_ly_optimal_prior,
        SUM(l14d_ly_optimal_prior) l14d_ly_optimal_prior,
        SUM(cq_dr_resilient_qtd_2w_prior) cq_dr_resilient_qtd_2w_prior,
        SUM(lyq_dr_resilient_qtd_2w_prior) lyq_dr_resilient_qtd_2w_prior,
        SUM(l14d_dr_resilient_prior) l14d_dr_resilient_prior,
        SUM(l14d_avg_dr_resilient_prior) l14d_avg_dr_resilient_prior,
        SUM(l14d_avg_ly_dr_resilient_prior) l14d_avg_ly_dr_resilient_prior,
        SUM(l14d_ly_dr_resilient_prior) l14d_ly_dr_resilient_prior,
        SUM(cq_product_resilient_rec_rev_qtd_2w_prior) cq_product_resilient_rec_rev_qtd_2w_prior,
        SUM(cq_ebr_usd_rec_rev_qtd_2w_prior) cq_ebr_usd_rec_rev_qtd_2w_prior,
        SUM(cq_capi_ebr_revenue_qtd_2w_prior) cq_capi_ebr_revenue_qtd_2w_prior,
        SUM(l14d_product_resilient_rec_rev_prior) l14d_product_resilient_rec_rev_prior,
        SUM(l14d_ebr_usd_rec_rev_prior) l14d_ebr_usd_rec_rev_prior,
        SUM(l14d_capi_ebr_revenue_prior) l14d_capi_ebr_revenue_prior,
        SUM(l14d_avg_product_resilient_rec_rev_prior) l14d_avg_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ebr_usd_rec_rev_prior) l14d_avg_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_capi_ebr_revenue_prior) l14d_avg_capi_ebr_revenue_prior,
        SUM(l14d_avg_ly_product_resilient_rec_rev_prior) l14d_avg_ly_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ly_ebr_usd_rec_rev_prior) l14d_avg_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_ly_capi_ebr_revenue_prior) l14d_avg_ly_capi_ebr_revenue_prior,
        SUM(l14d_ly_product_resilient_rec_rev_prior) l14d_ly_product_resilient_rec_rev_prior,
        SUM(l14d_ly_ebr_usd_rec_rev_prior) l14d_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_ly_capi_ebr_revenue_prior) l14d_ly_capi_ebr_revenue_prior,
        SUM(L14d_revenue) l14d_revenue,
        SUM(L14d_revenue_prior) l14d_revenue_prior,
        SUM(L14d_avg_revenue) l14d_avg_revenue,
        revenue_segment,
        'CP|RP Overlap' route_to_market
from

bpo_gms_quota_and_forecast_fast

where

(rp_username is not null and cp_username is not null)

group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24, revenue_segment

    """,
)

bpo_gms_quota_and_forecast_rtm_am_rp_overlap = PrestoInsertOperatorWithSchema(
    dep_list=[bpo_gms_quota_and_forecast_rtm_reporting],
    table="<TABLE:bpo_gms_quota_and_forecast_rtm_fast>",
    partition="ds=<DATEID>/route_to_market=AM|RP Overlap",
    documentation={
        "description": """Creates a Subpartition for AM|RP Overlap on Route to Market"""
    },
    create=Table(
        cols=[
            Column('ultimate_client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('ultimate_client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('program', 'VARCHAR','', HiveAnon.NONE),
            Column('vertical', 'VARCHAR','', HiveAnon.NONE),
            Column('segmentation', 'VARCHAR','', HiveAnon.NONE),
            Column('asofdate', 'VARCHAR','', HiveAnon.NONE),
            Column('quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('next_quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('days_left_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_left_in_quarter_prior', 'BIGINT','', HiveAnon.NONE),
            Column('days_total_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_closed_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('l12_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l4_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l2_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_subregion', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_region', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_market', 'VARCHAR','', HiveAnon.NONE),
            Column('country', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('run_rate_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('quota', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('employee_type_1', 'VARCHAR','', HiveAnon.NONE),
            Column('employee_type_2', 'VARCHAR','', HiveAnon.NONE),
            Column('l12_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('revenue_segment', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_product_resilient_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_ebr_usd_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_capi_ebr_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
        ],
        partitions=[
            Column('ds', 'VARCHAR', 'datestamp'),
            Column('route_to_market', 'VARCHAR', ''),
        ],
        retention=15,
    ),
    select=r"""
        Select
        ultimate_parent_fbid ultimate_client_fbid ,
        ultimate_parent_name ultimate_client_name ,
        advertiser_name client_name ,
        advertiser_fbid client_fbid ,
        program ,
        advertiser_vertical vertical ,
        segmentation ,
        asofdate ,
        quarter_id ,
        next_quarter_id ,
        days_left_in_quarter ,
        days_left_in_quarter_prior ,
        days_total_in_quarter ,
        days_closed_in_quarter ,
        l12_reporting_territory l12_territory ,
        l10_reporting_territory l10_territory ,
        l8_reporting_territory l8_territory  ,
        l6_reporting_territory l6_territory  ,
        l4_reporting_territory l4_territory  ,
        l2_reporting_territory l2_territory  ,
        sales_adv_subregion fb_subregion ,
        sales_adv_region fb_region ,
        market fb_market ,
        advertiser_country country ,
         NULL employee_type_1,
        NULL employee_type_2,
        NULL l12_territory_mgr,
        NULL l10_territory_mgr,
        NULL l8_territory_mgr,
        NULL l6_territory_mgr,
        SUM(run_rate_forecast) run_rate_forecast,
        SUM(run_rate_forecast_prior) run_rate_forecast_prior,
        SUM(advertiser_quota) quota,
        SUM(sales_forecast) sales_forecast,
        SUM(sales_forecast_prior) sales_forecast_prior,
        SUM(cq_revenue) cq_revenue,
        SUM(pq_revenue) pq_revenue,
        SUM(cq_revenue_qtd_prior) cq_revenue_qtd_prior,
        SUM(lyq_revenue) lyq_revenue,
        SUM(l2yq_revenue) l2yq_revenue,
        SUM(lyq_revenue_qtd) lyq_revenue_qtd,
        SUM(l2yq_revenue_qtd) l2yq_revenue_qtd,
        SUM(lyq_revenue_qtd_prior) lyq_revenue_qtd_prior,
        SUM(l2yq_revenue_qtd_prior) l2yq_revenue_qtd_prior,
        SUM(pq_revenue_qtd) pq_revenue_qtd,
        SUM(l7d_revenue) l7d_revenue,
        SUM(l7d_revenue_prior) l7d_revenue_prior,
        SUM(l7d_avg_revenue) l7d_avg_revenue,
        SUM(l7d_avg_revenue_prior) l7d_avg_revenue_prior,
        SUM(l7d_avg_ly_revenue) l7d_avg_ly_revenue,
        SUM(l7d_avg_ly_revenue_prior) l7d_avg_ly_revenue_prior,
        SUM(l7d_ly_revenue) l7d_ly_revenue,
        SUM(l7d_ly_revenue_prior) l7d_ly_revenue_prior,
        SUM(run_rate_forecast_2w_prior) run_rate_forecast_2w_prior,
        SUM(cq_revenue_qtd_2w_prior) cq_revenue_qtd_2w_prior,
        SUM(lyq_revenue_qtd_2w_prior) lyq_revenue_qtd_2w_prior,
        SUM(l2yq_revenue_qtd_2w_prior) l2yq_revenue_qtd_2w_prior,
        SUM(l14d_avg_revenue_prior) l14d_avg_revenue_prior,
        SUM(cq_optimal_qtd_2w_prior) cq_optimal_qtd_2w_prior,
        SUM(lyq_optimal_qtd_2w_prior) lyq_optimal_qtd_2w_prior,
        SUM(l14d_optimal_prior) l14d_optimal_prior,
        SUM(l14d_avg_optimal_prior) l14d_avg_optimal_prior,
        SUM(l14d_avg_ly_optimal_prior) l14d_avg_ly_optimal_prior,
        SUM(l14d_ly_optimal_prior) l14d_ly_optimal_prior,
        SUM(cq_dr_resilient_qtd_2w_prior) cq_dr_resilient_qtd_2w_prior,
        SUM(lyq_dr_resilient_qtd_2w_prior) lyq_dr_resilient_qtd_2w_prior,
        SUM(l14d_dr_resilient_prior) l14d_dr_resilient_prior,
        SUM(l14d_avg_dr_resilient_prior) l14d_avg_dr_resilient_prior,
        SUM(l14d_avg_ly_dr_resilient_prior) l14d_avg_ly_dr_resilient_prior,
        SUM(l14d_ly_dr_resilient_prior) l14d_ly_dr_resilient_prior,
        SUM(cq_product_resilient_rec_rev_qtd_2w_prior) cq_product_resilient_rec_rev_qtd_2w_prior,
        SUM(cq_ebr_usd_rec_rev_qtd_2w_prior) cq_ebr_usd_rec_rev_qtd_2w_prior,
        SUM(cq_capi_ebr_revenue_qtd_2w_prior) cq_capi_ebr_revenue_qtd_2w_prior,
        SUM(l14d_product_resilient_rec_rev_prior) l14d_product_resilient_rec_rev_prior,
        SUM(l14d_ebr_usd_rec_rev_prior) l14d_ebr_usd_rec_rev_prior,
        SUM(l14d_capi_ebr_revenue_prior) l14d_capi_ebr_revenue_prior,
        SUM(l14d_avg_product_resilient_rec_rev_prior) l14d_avg_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ebr_usd_rec_rev_prior) l14d_avg_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_capi_ebr_revenue_prior) l14d_avg_capi_ebr_revenue_prior,
        SUM(l14d_avg_ly_product_resilient_rec_rev_prior) l14d_avg_ly_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ly_ebr_usd_rec_rev_prior) l14d_avg_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_ly_capi_ebr_revenue_prior) l14d_avg_ly_capi_ebr_revenue_prior,
        SUM(l14d_ly_product_resilient_rec_rev_prior) l14d_ly_product_resilient_rec_rev_prior,
        SUM(l14d_ly_ebr_usd_rec_rev_prior) l14d_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_ly_capi_ebr_revenue_prior) l14d_ly_capi_ebr_revenue_prior,
        SUM(L14d_revenue) l14d_revenue,
        SUM(L14d_revenue_prior) l14d_revenue_prior,
        SUM(L14d_avg_revenue) l14d_avg_revenue,
        revenue_segment,
        'AM|RP Overlap' route_to_market
from

bpo_gms_quota_and_forecast_fast

where

(rp_username is not null and am_username is not null)

group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24, revenue_segment

    """,
)


bpo_gms_quota_and_forecast_rtm_ap_rp_overlap = PrestoInsertOperatorWithSchema(
    dep_list=[bpo_gms_quota_and_forecast_rtm_overlap],
    table="<TABLE:bpo_gms_quota_and_forecast_rtm_fast>",
    partition="ds=<DATEID>/route_to_market=AP|RP Overlap",
    documentation={
        "description": """Creates a Subpartition for AP|RP Overlap on Route to Market"""
    },
    create=Table(
        cols=[
            Column('ultimate_client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('ultimate_client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('program', 'VARCHAR','', HiveAnon.NONE),
            Column('vertical', 'VARCHAR','', HiveAnon.NONE),
            Column('segmentation', 'VARCHAR','', HiveAnon.NONE),
            Column('asofdate', 'VARCHAR','', HiveAnon.NONE),
            Column('quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('next_quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('days_left_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_left_in_quarter_prior', 'BIGINT','', HiveAnon.NONE),
            Column('days_total_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_closed_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('l12_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l4_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l2_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_subregion', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_region', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_market', 'VARCHAR','', HiveAnon.NONE),
            Column('country', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('run_rate_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('quota', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('employee_type_1', 'VARCHAR','', HiveAnon.NONE),
            Column('employee_type_2', 'VARCHAR','', HiveAnon.NONE),
            Column('l12_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('revenue_segment', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_product_resilient_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_ebr_usd_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_capi_ebr_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
        ],
        partitions=[
            Column('ds', 'VARCHAR', 'datestamp'),
            Column('route_to_market', 'VARCHAR', ''),
        ],
        retention=15,
    ),
    select=r"""
        Select
        planning_agency_ult_fbid ultimate_client_fbid ,
        planning_agency_ult_name ultimate_client_name ,
        planning_agency_name client_name ,
        planning_agency_fbid client_fbid ,
        program_agency program,
        'Not Available' vertical ,
        'Not Available' segmentation ,
        asofdate ,
        quarter_id ,
        next_quarter_id ,
        days_left_in_quarter ,
        days_left_in_quarter_prior ,
        days_total_in_quarter ,
        days_closed_in_quarter ,
        l12_agency_territory l12_territory ,
        l10_agency_territory l10_territory ,
        l8_agency_territory l8_territory  ,
        l6_agency_territory l6_territory  ,
        l4_agency_territory l4_territory  ,
        l2_agency_territory l2_territory  ,
        sub_region_agc fb_subregion ,
        region_agc fb_region ,
        market_agc fb_market ,
        country_agc country ,
        NULL employee_type_1,
        NULL employee_type_2,
        NULL l12_territory_mgr,
        NULL l10_territory_mgr,
        NULL l8_territory_mgr,
        NULL l6_territory_mgr,
        SUM(run_rate_forecast) run_rate_forecast,
        SUM(run_rate_forecast_prior) run_rate_forecast_prior,
        SUM(agency_quota) quota,
        null sales_forecast,
        null sales_forecast_prior,
        SUM(cq_revenue) cq_revenue,
        SUM(pq_revenue) pq_revenue,
        SUM(cq_revenue_qtd_prior) cq_revenue_qtd_prior,
        SUM(lyq_revenue) lyq_revenue,
        SUM(l2yq_revenue) l2yq_revenue,
        SUM(lyq_revenue_qtd) lyq_revenue_qtd,
        SUM(l2yq_revenue_qtd) l2yq_revenue_qtd,
        SUM(lyq_revenue_qtd_prior) lyq_revenue_qtd_prior,
        SUM(l2yq_revenue_qtd_prior) l2yq_revenue_qtd_prior,
        SUM(pq_revenue_qtd) pq_revenue_qtd,
        SUM(l7d_revenue) l7d_revenue,
        SUM(l7d_revenue_prior) l7d_revenue_prior,
        SUM(l7d_avg_revenue) l7d_avg_revenue,
        SUM(l7d_avg_revenue_prior) l7d_avg_revenue_prior,
        SUM(l7d_avg_ly_revenue) l7d_avg_ly_revenue,
        SUM(l7d_avg_ly_revenue_prior) l7d_avg_ly_revenue_prior,
        SUM(l7d_ly_revenue) l7d_ly_revenue,
        SUM(l7d_ly_revenue_prior) l7d_ly_revenue_prior,
        SUM(run_rate_forecast_2w_prior) run_rate_forecast_2w_prior,
        SUM(cq_revenue_qtd_2w_prior) cq_revenue_qtd_2w_prior,
        SUM(lyq_revenue_qtd_2w_prior) lyq_revenue_qtd_2w_prior,
        SUM(l2yq_revenue_qtd_2w_prior) l2yq_revenue_qtd_2w_prior,
        SUM(l14d_avg_revenue_prior) l14d_avg_revenue_prior,
        SUM(cq_optimal_qtd_2w_prior) cq_optimal_qtd_2w_prior,
        SUM(lyq_optimal_qtd_2w_prior) lyq_optimal_qtd_2w_prior,
        SUM(l14d_optimal_prior) l14d_optimal_prior,
        SUM(l14d_avg_optimal_prior) l14d_avg_optimal_prior,
        SUM(l14d_avg_ly_optimal_prior) l14d_avg_ly_optimal_prior,
        SUM(l14d_ly_optimal_prior) l14d_ly_optimal_prior,
        SUM(cq_dr_resilient_qtd_2w_prior) cq_dr_resilient_qtd_2w_prior,
        SUM(lyq_dr_resilient_qtd_2w_prior) lyq_dr_resilient_qtd_2w_prior,
        SUM(l14d_dr_resilient_prior) l14d_dr_resilient_prior,
        SUM(l14d_avg_dr_resilient_prior) l14d_avg_dr_resilient_prior,
        SUM(l14d_avg_ly_dr_resilient_prior) l14d_avg_ly_dr_resilient_prior,
        SUM(l14d_ly_dr_resilient_prior) l14d_ly_dr_resilient_prior,
        SUM(cq_product_resilient_rec_rev_qtd_2w_prior) cq_product_resilient_rec_rev_qtd_2w_prior,
        SUM(cq_ebr_usd_rec_rev_qtd_2w_prior) cq_ebr_usd_rec_rev_qtd_2w_prior,
        SUM(cq_capi_ebr_revenue_qtd_2w_prior) cq_capi_ebr_revenue_qtd_2w_prior,
        SUM(l14d_product_resilient_rec_rev_prior) l14d_product_resilient_rec_rev_prior,
        SUM(l14d_ebr_usd_rec_rev_prior) l14d_ebr_usd_rec_rev_prior,
        SUM(l14d_capi_ebr_revenue_prior) l14d_capi_ebr_revenue_prior,
        SUM(l14d_avg_product_resilient_rec_rev_prior) l14d_avg_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ebr_usd_rec_rev_prior) l14d_avg_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_capi_ebr_revenue_prior) l14d_avg_capi_ebr_revenue_prior,
        SUM(l14d_avg_ly_product_resilient_rec_rev_prior) l14d_avg_ly_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ly_ebr_usd_rec_rev_prior) l14d_avg_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_ly_capi_ebr_revenue_prior) l14d_avg_ly_capi_ebr_revenue_prior,
        SUM(l14d_ly_product_resilient_rec_rev_prior) l14d_ly_product_resilient_rec_rev_prior,
        SUM(l14d_ly_ebr_usd_rec_rev_prior) l14d_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_ly_capi_ebr_revenue_prior) l14d_ly_capi_ebr_revenue_prior,
        SUM(L14d_revenue) l14d_revenue,
        SUM(L14d_revenue_prior) l14d_revenue_prior,
        SUM(L14d_avg_revenue) l14d_avg_revenue,
        program_agency revenue_segment,
        'AP|RP Overlap' route_to_market
from

bpo_gms_quota_and_forecast_fast

where (rp_username is not null and ap_username is not null)

group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,revenue_segment

    """,
)

bpo_gms_quota_and_forecast_rtm_pm_rp_overlap = PrestoInsertOperatorWithSchema(
    dep_list=[bpo_gms_quota_and_forecast_rtm_overlap],
    table="<TABLE:bpo_gms_quota_and_forecast_rtm_fast>",
    partition="ds=<DATEID>/route_to_market=PM|RP Overlap",
    documentation={
        "description": """Creates a Subpartition for PM|RP Overlap on Route to Market"""
    },
    create=Table(
        cols=[
            Column('ultimate_client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('ultimate_client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('program', 'VARCHAR','', HiveAnon.NONE),
            Column('vertical', 'VARCHAR','', HiveAnon.NONE),
            Column('segmentation', 'VARCHAR','', HiveAnon.NONE),
            Column('asofdate', 'VARCHAR','', HiveAnon.NONE),
            Column('quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('next_quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('days_left_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_left_in_quarter_prior', 'BIGINT','', HiveAnon.NONE),
            Column('days_total_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_closed_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('l12_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l4_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l2_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_subregion', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_region', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_market', 'VARCHAR','', HiveAnon.NONE),
            Column('country', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('run_rate_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('quota', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('employee_type_1', 'VARCHAR','', HiveAnon.NONE),
            Column('employee_type_2', 'VARCHAR','', HiveAnon.NONE),
            Column('l12_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('revenue_segment', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_product_resilient_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_ebr_usd_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_capi_ebr_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
        ],
        partitions=[
            Column('ds', 'VARCHAR', 'datestamp'),
            Column('route_to_market', 'VARCHAR', ''),
        ],
        retention=15,
    ),
    select=r"""
        Select
        planning_agency_ult_fbid ultimate_client_fbid ,
        planning_agency_ult_name ultimate_client_name ,
        planning_agency_name client_name ,
        planning_agency_fbid client_fbid ,
        program_agency program,
        'Not Available' vertical ,
        'Not Available' segmentation ,
        asofdate ,
        quarter_id ,
        next_quarter_id ,
        days_left_in_quarter ,
        days_left_in_quarter_prior ,
        days_total_in_quarter ,
        days_closed_in_quarter ,
        l12_agency_territory l12_territory ,
        l10_agency_territory l10_territory ,
        l8_agency_territory l8_territory  ,
        l6_agency_territory l6_territory  ,
        l4_agency_territory l4_territory  ,
        l2_agency_territory l2_territory  ,
        sub_region_agc fb_subregion ,
        region_agc fb_region ,
        market_agc fb_market ,
        country_agc country ,
        NULL employee_type_1,
        NULL employee_type_2,
        NULL l12_territory_mgr,
        NULL l10_territory_mgr,
        NULL l8_territory_mgr,
        NULL l6_territory_mgr,
        SUM(run_rate_forecast) run_rate_forecast,
        SUM(run_rate_forecast_prior) run_rate_forecast_prior,
        SUM(agency_quota) quota,
        null sales_forecast,
        null sales_forecast_prior,
        SUM(cq_revenue) cq_revenue,
        SUM(pq_revenue) pq_revenue,
        SUM(cq_revenue_qtd_prior) cq_revenue_qtd_prior,
        SUM(lyq_revenue) lyq_revenue,
        SUM(l2yq_revenue) l2yq_revenue,
        SUM(lyq_revenue_qtd) lyq_revenue_qtd,
        SUM(l2yq_revenue_qtd) l2yq_revenue_qtd,
        SUM(lyq_revenue_qtd_prior) lyq_revenue_qtd_prior,
        SUM(l2yq_revenue_qtd_prior) l2yq_revenue_qtd_prior,
        SUM(pq_revenue_qtd) pq_revenue_qtd,
        SUM(l7d_revenue) l7d_revenue,
        SUM(l7d_revenue_prior) l7d_revenue_prior,
        SUM(l7d_avg_revenue) l7d_avg_revenue,
        SUM(l7d_avg_revenue_prior) l7d_avg_revenue_prior,
        SUM(l7d_avg_ly_revenue) l7d_avg_ly_revenue,
        SUM(l7d_avg_ly_revenue_prior) l7d_avg_ly_revenue_prior,
        SUM(l7d_ly_revenue) l7d_ly_revenue,
        SUM(l7d_ly_revenue_prior) l7d_ly_revenue_prior,
        SUM(run_rate_forecast_2w_prior) run_rate_forecast_2w_prior,
        SUM(cq_revenue_qtd_2w_prior) cq_revenue_qtd_2w_prior,
        SUM(lyq_revenue_qtd_2w_prior) lyq_revenue_qtd_2w_prior,
        SUM(l2yq_revenue_qtd_2w_prior) l2yq_revenue_qtd_2w_prior,
        SUM(l14d_avg_revenue_prior) l14d_avg_revenue_prior,
        SUM(cq_optimal_qtd_2w_prior) cq_optimal_qtd_2w_prior,
        SUM(lyq_optimal_qtd_2w_prior) lyq_optimal_qtd_2w_prior,
        SUM(l14d_optimal_prior) l14d_optimal_prior,
        SUM(l14d_avg_optimal_prior) l14d_avg_optimal_prior,
        SUM(l14d_avg_ly_optimal_prior) l14d_avg_ly_optimal_prior,
        SUM(l14d_ly_optimal_prior) l14d_ly_optimal_prior,
        SUM(cq_dr_resilient_qtd_2w_prior) cq_dr_resilient_qtd_2w_prior,
        SUM(lyq_dr_resilient_qtd_2w_prior) lyq_dr_resilient_qtd_2w_prior,
        SUM(l14d_dr_resilient_prior) l14d_dr_resilient_prior,
        SUM(l14d_avg_dr_resilient_prior) l14d_avg_dr_resilient_prior,
        SUM(l14d_avg_ly_dr_resilient_prior) l14d_avg_ly_dr_resilient_prior,
        SUM(l14d_ly_dr_resilient_prior) l14d_ly_dr_resilient_prior,
        SUM(cq_product_resilient_rec_rev_qtd_2w_prior) cq_product_resilient_rec_rev_qtd_2w_prior,
        SUM(cq_ebr_usd_rec_rev_qtd_2w_prior) cq_ebr_usd_rec_rev_qtd_2w_prior,
        SUM(cq_capi_ebr_revenue_qtd_2w_prior) cq_capi_ebr_revenue_qtd_2w_prior,
        SUM(l14d_product_resilient_rec_rev_prior) l14d_product_resilient_rec_rev_prior,
        SUM(l14d_ebr_usd_rec_rev_prior) l14d_ebr_usd_rec_rev_prior,
        SUM(l14d_capi_ebr_revenue_prior) l14d_capi_ebr_revenue_prior,
        SUM(l14d_avg_product_resilient_rec_rev_prior) l14d_avg_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ebr_usd_rec_rev_prior) l14d_avg_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_capi_ebr_revenue_prior) l14d_avg_capi_ebr_revenue_prior,
        SUM(l14d_avg_ly_product_resilient_rec_rev_prior) l14d_avg_ly_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ly_ebr_usd_rec_rev_prior) l14d_avg_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_ly_capi_ebr_revenue_prior) l14d_avg_ly_capi_ebr_revenue_prior,
        SUM(l14d_ly_product_resilient_rec_rev_prior) l14d_ly_product_resilient_rec_rev_prior,
        SUM(l14d_ly_ebr_usd_rec_rev_prior) l14d_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_ly_capi_ebr_revenue_prior) l14d_ly_capi_ebr_revenue_prior,
        SUM(L14d_revenue) l14d_revenue,
        SUM(L14d_revenue_prior) l14d_revenue_prior,
        SUM(L14d_avg_revenue) l14d_avg_revenue,
        program_agency revenue_segment,
        'PM|RP Overlap' route_to_market
from

bpo_gms_quota_and_forecast_fast

where
(rp_username is not null and pm_username is not null)

group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24, revenue_segment

    """,
)

bpo_gms_quota_and_forecast_rtm_agency_overlap = PrestoInsertOperatorWithSchema(
    dep_list=[bpo_gms_quota_and_forecast_rtm_overlap],
    table="<TABLE:bpo_gms_quota_and_forecast_rtm_fast>",
    partition="ds=<DATEID>/route_to_market=Agency Overlap",
    documentation={
        "description": """Creates a Subpartition for Agency Overlap on Route to Market"""
    },
    create=Table(
        cols=[
            Column('ultimate_client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('ultimate_client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('program', 'VARCHAR','', HiveAnon.NONE),
            Column('vertical', 'VARCHAR','', HiveAnon.NONE),
            Column('segmentation', 'VARCHAR','', HiveAnon.NONE),
            Column('asofdate', 'VARCHAR','', HiveAnon.NONE),
            Column('quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('next_quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('days_left_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_left_in_quarter_prior', 'BIGINT','', HiveAnon.NONE),
            Column('days_total_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_closed_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('l12_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l4_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l2_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_subregion', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_region', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_market', 'VARCHAR','', HiveAnon.NONE),
            Column('country', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('run_rate_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('quota', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('employee_type_1', 'VARCHAR','', HiveAnon.NONE),
            Column('employee_type_2', 'VARCHAR','', HiveAnon.NONE),
            Column('l12_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('revenue_segment', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_product_resilient_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_ebr_usd_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_capi_ebr_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
        ],
        partitions=[
            Column('ds', 'VARCHAR', 'datestamp'),
            Column('route_to_market', 'VARCHAR', ''),
        ],
        retention=15,
    ),
    select=r"""
        Select
        planning_agency_ult_fbid ultimate_client_fbid ,
        planning_agency_ult_name ultimate_client_name ,
        planning_agency_name client_name ,
        planning_agency_fbid client_fbid ,
        program_agency program,
        'Not Available' vertical ,
        'Not Available' segmentation ,
        asofdate ,
        quarter_id ,
        next_quarter_id ,
        days_left_in_quarter ,
        days_left_in_quarter_prior ,
        days_total_in_quarter ,
        days_closed_in_quarter ,
        l12_agency_territory l12_territory ,
        l10_agency_territory l10_territory ,
        l8_agency_territory l8_territory  ,
        l6_agency_territory l6_territory  ,
        l4_agency_territory l4_territory  ,
        l2_agency_territory l2_territory  ,
        sub_region_agc fb_subregion ,
        region_agc fb_region ,
        market_agc fb_market ,
        country_agc country ,
        ap_username employee_type_1,
        pm_username employee_type_2,
        l12_manager_agency_territory l12_territory_mgr,
        l10_manager_agency_territory l10_territory_mgr,
        l8_manager_agency_territory l8_territory_mgr,
        l6_manager_agency_territory l6_territory_mgr,
        SUM(run_rate_forecast) run_rate_forecast,
        SUM(run_rate_forecast_prior) run_rate_forecast_prior,
        SUM(agency_quota) quota,
        null sales_forecast,
        null sales_forecast_prior,
        SUM(cq_revenue) cq_revenue,
        SUM(pq_revenue) pq_revenue,
        SUM(cq_revenue_qtd_prior) cq_revenue_qtd_prior,
        SUM(lyq_revenue) lyq_revenue,
        SUM(l2yq_revenue) l2yq_revenue,
        SUM(lyq_revenue_qtd) lyq_revenue_qtd,
        SUM(l2yq_revenue_qtd) l2yq_revenue_qtd,
        SUM(lyq_revenue_qtd_prior) lyq_revenue_qtd_prior,
        SUM(l2yq_revenue_qtd_prior) l2yq_revenue_qtd_prior,
        SUM(pq_revenue_qtd) pq_revenue_qtd,
        SUM(l7d_revenue) l7d_revenue,
        SUM(l7d_revenue_prior) l7d_revenue_prior,
        SUM(l7d_avg_revenue) l7d_avg_revenue,
        SUM(l7d_avg_revenue_prior) l7d_avg_revenue_prior,
        SUM(l7d_avg_ly_revenue) l7d_avg_ly_revenue,
        SUM(l7d_avg_ly_revenue_prior) l7d_avg_ly_revenue_prior,
        SUM(l7d_ly_revenue) l7d_ly_revenue,
        SUM(l7d_ly_revenue_prior) l7d_ly_revenue_prior,
        SUM(run_rate_forecast_2w_prior) run_rate_forecast_2w_prior,
        SUM(cq_revenue_qtd_2w_prior) cq_revenue_qtd_2w_prior,
        SUM(lyq_revenue_qtd_2w_prior) lyq_revenue_qtd_2w_prior,
        SUM(l2yq_revenue_qtd_2w_prior) l2yq_revenue_qtd_2w_prior,
        SUM(l14d_avg_revenue_prior) l14d_avg_revenue_prior,
        SUM(cq_optimal_qtd_2w_prior) cq_optimal_qtd_2w_prior,
        SUM(lyq_optimal_qtd_2w_prior) lyq_optimal_qtd_2w_prior,
        SUM(l14d_optimal_prior) l14d_optimal_prior,
        SUM(l14d_avg_optimal_prior) l14d_avg_optimal_prior,
        SUM(l14d_avg_ly_optimal_prior) l14d_avg_ly_optimal_prior,
        SUM(l14d_ly_optimal_prior) l14d_ly_optimal_prior,
        SUM(cq_dr_resilient_qtd_2w_prior) cq_dr_resilient_qtd_2w_prior,
        SUM(lyq_dr_resilient_qtd_2w_prior) lyq_dr_resilient_qtd_2w_prior,
        SUM(l14d_dr_resilient_prior) l14d_dr_resilient_prior,
        SUM(l14d_avg_dr_resilient_prior) l14d_avg_dr_resilient_prior,
        SUM(l14d_avg_ly_dr_resilient_prior) l14d_avg_ly_dr_resilient_prior,
        SUM(l14d_ly_dr_resilient_prior) l14d_ly_dr_resilient_prior,
        SUM(cq_product_resilient_rec_rev_qtd_2w_prior) cq_product_resilient_rec_rev_qtd_2w_prior,
        SUM(cq_ebr_usd_rec_rev_qtd_2w_prior) cq_ebr_usd_rec_rev_qtd_2w_prior,
        SUM(cq_capi_ebr_revenue_qtd_2w_prior) cq_capi_ebr_revenue_qtd_2w_prior,
        SUM(l14d_product_resilient_rec_rev_prior) l14d_product_resilient_rec_rev_prior,
        SUM(l14d_ebr_usd_rec_rev_prior) l14d_ebr_usd_rec_rev_prior,
        SUM(l14d_capi_ebr_revenue_prior) l14d_capi_ebr_revenue_prior,
        SUM(l14d_avg_product_resilient_rec_rev_prior) l14d_avg_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ebr_usd_rec_rev_prior) l14d_avg_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_capi_ebr_revenue_prior) l14d_avg_capi_ebr_revenue_prior,
        SUM(l14d_avg_ly_product_resilient_rec_rev_prior) l14d_avg_ly_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ly_ebr_usd_rec_rev_prior) l14d_avg_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_ly_capi_ebr_revenue_prior) l14d_avg_ly_capi_ebr_revenue_prior,
        SUM(l14d_ly_product_resilient_rec_rev_prior) l14d_ly_product_resilient_rec_rev_prior,
        SUM(l14d_ly_ebr_usd_rec_rev_prior) l14d_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_ly_capi_ebr_revenue_prior) l14d_ly_capi_ebr_revenue_prior,
        SUM(L14d_revenue) l14d_revenue,
        SUM(L14d_revenue_prior) l14d_revenue_prior,
        SUM(L14d_avg_revenue) l14d_avg_revenue,
        program_agency revenue_segment,
        'Agency Overlap' route_to_market
from

bpo_gms_quota_and_forecast_fast

where
(cp_username is not null and ap_username is not null) or
(am_username is not null and pm_username is not null) or
(pm_username is not null and cp_username is not null) or
(am_username is not null and cp_username is not null) or
(am_username is not null and cp_username is not null) or
(ap_username is not null and pm_username is not null) or
(ap_username is not null and am_username is not null) or
(rp_username is not null and cp_username is not null) or
(rp_username is not null and ap_username is not null) or
(rp_username is not null and pm_username is not null) or
(rp_username is not null and am_username is not null) and
l2_agency_territory = 'GBG Agency'

group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,revenue_segment

    """,
)

bpo_gms_quota_and_forecast_rtm_reseller_overlap = PrestoInsertOperatorWithSchema(
    dep_list=[bpo_gms_quota_and_forecast_rtm_agency_overlap],
    table="<TABLE:bpo_gms_quota_and_forecast_rtm_fast>",
    partition="ds=<DATEID>/route_to_market=Reseller Overlap",
    documentation={
        "description": """Creates a Subpartition for Reseller Overlap on Route to Market"""
    },
    create=Table(
        cols=[
            Column('ultimate_client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('ultimate_client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('program', 'VARCHAR','', HiveAnon.NONE),
            Column('vertical', 'VARCHAR','', HiveAnon.NONE),
            Column('segmentation', 'VARCHAR','', HiveAnon.NONE),
            Column('asofdate', 'VARCHAR','', HiveAnon.NONE),
            Column('quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('next_quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('days_left_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_left_in_quarter_prior', 'BIGINT','', HiveAnon.NONE),
            Column('days_total_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_closed_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('l12_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l4_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l2_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_subregion', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_region', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_market', 'VARCHAR','', HiveAnon.NONE),
            Column('country', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('run_rate_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('quota', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('employee_type_1', 'VARCHAR','', HiveAnon.NONE),
            Column('employee_type_2', 'VARCHAR','', HiveAnon.NONE),
            Column('l12_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('revenue_segment', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_product_resilient_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_ebr_usd_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_capi_ebr_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
        ],
        partitions=[
            Column('ds', 'VARCHAR', 'datestamp'),
            Column('route_to_market', 'VARCHAR', ''),
        ],
        retention=15,
    ),
    select=r"""
        Select
        reseller_fbid ultimate_client_fbid ,
        reseller_name ultimate_client_name ,
        reseller_name client_name ,
        reseller_fbid client_fbid ,
        'Reseller' program,
        'Not Available' vertical ,
        'Not Available' segmentation ,
        asofdate ,
        quarter_id ,
        next_quarter_id ,
        days_left_in_quarter ,
        days_left_in_quarter_prior ,
        days_total_in_quarter ,
        days_closed_in_quarter ,
        l12_reseller_territory l12_territory ,
        l10_reseller_territory l10_territory ,
        l8_reseller_territory l8_territory  ,
        l6_reseller_territory l6_territory  ,
        l4_reseller_territory l4_territory  ,
        l2_reseller_territory l2_territory  ,
        'Not Available' fb_subregion ,
        'Not Available' fb_region ,
        'Not Available' fb_market ,
        'Not Available' country ,
        rp_username employee_type_1,
        NULL employee_type_2,
        l12_reseller_terr_mgr l12_territory_mgr,
        l10_reseller_terr_mgr l10_territory_mgr,
        l8_reseller_terr_mgr l8_territory_mgr,
        l6_reseller_terr_mgr l6_territory_mgr,
        SUM(run_rate_forecast) run_rate_forecast,
        SUM(run_rate_forecast_prior) run_rate_forecast_prior,
        SUM(reseller_quota) quota,
        null sales_forecast,
        null sales_forecast_prior,
        SUM(cq_revenue) cq_revenue,
        SUM(pq_revenue) pq_revenue,
        SUM(cq_revenue_qtd_prior) cq_revenue_qtd_prior,
        SUM(lyq_revenue) lyq_revenue,
        SUM(l2yq_revenue) l2yq_revenue,
        SUM(lyq_revenue_qtd) lyq_revenue_qtd,
        SUM(l2yq_revenue_qtd) l2yq_revenue_qtd,
        SUM(lyq_revenue_qtd_prior) lyq_revenue_qtd_prior,
        SUM(l2yq_revenue_qtd_prior) l2yq_revenue_qtd_prior,
        SUM(pq_revenue_qtd) pq_revenue_qtd,
        SUM(l7d_revenue) l7d_revenue,
        SUM(l7d_revenue_prior) l7d_revenue_prior,
        SUM(l7d_avg_revenue) l7d_avg_revenue,
        SUM(l7d_avg_revenue_prior) l7d_avg_revenue_prior,
        SUM(l7d_avg_ly_revenue) l7d_avg_ly_revenue,
        SUM(l7d_avg_ly_revenue_prior) l7d_avg_ly_revenue_prior,
        SUM(l7d_ly_revenue) l7d_ly_revenue,
        SUM(l7d_ly_revenue_prior) l7d_ly_revenue_prior,
        SUM(run_rate_forecast_2w_prior) run_rate_forecast_2w_prior,
        SUM(cq_revenue_qtd_2w_prior) cq_revenue_qtd_2w_prior,
        SUM(lyq_revenue_qtd_2w_prior) lyq_revenue_qtd_2w_prior,
        SUM(l2yq_revenue_qtd_2w_prior) l2yq_revenue_qtd_2w_prior,
        SUM(l14d_avg_revenue_prior) l14d_avg_revenue_prior,
        SUM(cq_optimal_qtd_2w_prior) cq_optimal_qtd_2w_prior,
        SUM(lyq_optimal_qtd_2w_prior) lyq_optimal_qtd_2w_prior,
        SUM(l14d_optimal_prior) l14d_optimal_prior,
        SUM(l14d_avg_optimal_prior) l14d_avg_optimal_prior,
        SUM(l14d_avg_ly_optimal_prior) l14d_avg_ly_optimal_prior,
        SUM(l14d_ly_optimal_prior) l14d_ly_optimal_prior,
        SUM(cq_dr_resilient_qtd_2w_prior) cq_dr_resilient_qtd_2w_prior,
        SUM(lyq_dr_resilient_qtd_2w_prior) lyq_dr_resilient_qtd_2w_prior,
        SUM(l14d_dr_resilient_prior) l14d_dr_resilient_prior,
        SUM(l14d_avg_dr_resilient_prior) l14d_avg_dr_resilient_prior,
        SUM(l14d_avg_ly_dr_resilient_prior) l14d_avg_ly_dr_resilient_prior,
        SUM(l14d_ly_dr_resilient_prior) l14d_ly_dr_resilient_prior,
        SUM(cq_product_resilient_rec_rev_qtd_2w_prior) cq_product_resilient_rec_rev_qtd_2w_prior,
        SUM(cq_ebr_usd_rec_rev_qtd_2w_prior) cq_ebr_usd_rec_rev_qtd_2w_prior,
        SUM(cq_capi_ebr_revenue_qtd_2w_prior) cq_capi_ebr_revenue_qtd_2w_prior,
        SUM(l14d_product_resilient_rec_rev_prior) l14d_product_resilient_rec_rev_prior,
        SUM(l14d_ebr_usd_rec_rev_prior) l14d_ebr_usd_rec_rev_prior,
        SUM(l14d_capi_ebr_revenue_prior) l14d_capi_ebr_revenue_prior,
        SUM(l14d_avg_product_resilient_rec_rev_prior) l14d_avg_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ebr_usd_rec_rev_prior) l14d_avg_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_capi_ebr_revenue_prior) l14d_avg_capi_ebr_revenue_prior,
        SUM(l14d_avg_ly_product_resilient_rec_rev_prior) l14d_avg_ly_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ly_ebr_usd_rec_rev_prior) l14d_avg_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_ly_capi_ebr_revenue_prior) l14d_avg_ly_capi_ebr_revenue_prior,
        SUM(l14d_ly_product_resilient_rec_rev_prior) l14d_ly_product_resilient_rec_rev_prior,
        SUM(l14d_ly_ebr_usd_rec_rev_prior) l14d_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_ly_capi_ebr_revenue_prior) l14d_ly_capi_ebr_revenue_prior,
        SUM(L14d_revenue) l14d_revenue,
        SUM(L14d_revenue_prior) l14d_revenue_prior,
        SUM(L14d_avg_revenue) l14d_avg_revenue,
        revenue_segment,
        'Reseller Overlap' route_to_market
from

bpo_gms_quota_and_forecast_fast

where
(rp_username is not null and cp_username is not null) or
(rp_username is not null and ap_username is not null) or
(rp_username is not null and pm_username is not null) or
(rp_username is not null and am_username is not null) and
l2_reseller_territory = 'Reseller'

group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,revenue_segment

    """,
)


bpo_gms_quota_and_forecast_rtm_agency_no_overlap = PrestoInsertOperatorWithSchema(
    dep_list=[bpo_gms_quota_and_forecast_rtm_reseller_overlap],
    table="<TABLE:bpo_gms_quota_and_forecast_rtm_fast>",
    partition="ds=<DATEID>/route_to_market=Agency No Overlap",
    documentation={
        "description": """Creates a Subpartition for Agency No Overlap on Route to Market"""
    },
    create=Table(
        cols=[
            Column('ultimate_client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('ultimate_client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('program', 'VARCHAR','', HiveAnon.NONE),
            Column('vertical', 'VARCHAR','', HiveAnon.NONE),
            Column('segmentation', 'VARCHAR','', HiveAnon.NONE),
            Column('asofdate', 'VARCHAR','', HiveAnon.NONE),
            Column('quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('next_quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('days_left_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_left_in_quarter_prior', 'BIGINT','', HiveAnon.NONE),
            Column('days_total_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_closed_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('l12_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l4_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l2_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_subregion', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_region', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_market', 'VARCHAR','', HiveAnon.NONE),
            Column('country', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('run_rate_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('quota', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('employee_type_1', 'VARCHAR','', HiveAnon.NONE),
            Column('employee_type_2', 'VARCHAR','', HiveAnon.NONE),
            Column('l12_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('revenue_segment', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_product_resilient_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_ebr_usd_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_capi_ebr_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
        ],
        partitions=[
            Column('ds', 'VARCHAR', 'datestamp'),
            Column('route_to_market', 'VARCHAR', ''),
        ],
        retention=15,
    ),
    select=r"""
        Select
        planning_agency_ult_fbid ultimate_client_fbid ,
        planning_agency_ult_name ultimate_client_name ,
        planning_agency_name client_name ,
        planning_agency_fbid client_fbid ,
        program_agency program,
        'Not Available' vertical ,
        'Not Available' segmentation ,
        asofdate ,
        quarter_id ,
        next_quarter_id ,
        days_left_in_quarter ,
        days_left_in_quarter_prior ,
        days_total_in_quarter ,
        days_closed_in_quarter ,
        l12_agency_territory l12_territory ,
        l10_agency_territory l10_territory ,
        l8_agency_territory l8_territory  ,
        l6_agency_territory l6_territory  ,
        l4_agency_territory l4_territory  ,
        l2_agency_territory l2_territory  ,
        sub_region_agc fb_subregion ,
        region_agc fb_region ,
        market_agc fb_market ,
        country_agc country ,
        NULL employee_type_1,
        NULL employee_type_2,
        NULL l12_territory_mgr,
        NULL l10_territory_mgr,
        NULL l8_territory_mgr,
        NULL l6_territory_mgr,
        SUM(run_rate_forecast) run_rate_forecast,
        SUM(run_rate_forecast_prior) run_rate_forecast_prior,
        SUM(agency_quota) quota,
        null sales_forecast,
        null sales_forecast_prior,
        SUM(cq_revenue) cq_revenue,
        SUM(pq_revenue) pq_revenue,
        SUM(cq_revenue_qtd_prior) cq_revenue_qtd_prior,
        SUM(lyq_revenue) lyq_revenue,
        SUM(l2yq_revenue) l2yq_revenue,
        SUM(lyq_revenue_qtd) lyq_revenue_qtd,
        SUM(l2yq_revenue_qtd) l2yq_revenue_qtd,
        SUM(lyq_revenue_qtd_prior) lyq_revenue_qtd_prior,
        SUM(l2yq_revenue_qtd_prior) l2yq_revenue_qtd_prior,
        SUM(pq_revenue_qtd) pq_revenue_qtd,
        SUM(l7d_revenue) l7d_revenue,
        SUM(l7d_revenue_prior) l7d_revenue_prior,
        SUM(l7d_avg_revenue) l7d_avg_revenue,
        SUM(l7d_avg_revenue_prior) l7d_avg_revenue_prior,
        SUM(l7d_avg_ly_revenue) l7d_avg_ly_revenue,
        SUM(l7d_avg_ly_revenue_prior) l7d_avg_ly_revenue_prior,
        SUM(l7d_ly_revenue) l7d_ly_revenue,
        SUM(l7d_ly_revenue_prior) l7d_ly_revenue_prior,
        SUM(run_rate_forecast_2w_prior) run_rate_forecast_2w_prior,
        SUM(cq_revenue_qtd_2w_prior) cq_revenue_qtd_2w_prior,
        SUM(lyq_revenue_qtd_2w_prior) lyq_revenue_qtd_2w_prior,
        SUM(l2yq_revenue_qtd_2w_prior) l2yq_revenue_qtd_2w_prior,
        SUM(l14d_avg_revenue_prior) l14d_avg_revenue_prior,
        SUM(cq_optimal_qtd_2w_prior) cq_optimal_qtd_2w_prior,
        SUM(lyq_optimal_qtd_2w_prior) lyq_optimal_qtd_2w_prior,
        SUM(l14d_optimal_prior) l14d_optimal_prior,
        SUM(l14d_avg_optimal_prior) l14d_avg_optimal_prior,
        SUM(l14d_avg_ly_optimal_prior) l14d_avg_ly_optimal_prior,
        SUM(l14d_ly_optimal_prior) l14d_ly_optimal_prior,
        SUM(cq_dr_resilient_qtd_2w_prior) cq_dr_resilient_qtd_2w_prior,
        SUM(lyq_dr_resilient_qtd_2w_prior) lyq_dr_resilient_qtd_2w_prior,
        SUM(l14d_dr_resilient_prior) l14d_dr_resilient_prior,
        SUM(l14d_avg_dr_resilient_prior) l14d_avg_dr_resilient_prior,
        SUM(l14d_avg_ly_dr_resilient_prior) l14d_avg_ly_dr_resilient_prior,
        SUM(l14d_ly_dr_resilient_prior) l14d_ly_dr_resilient_prior,
        SUM(cq_product_resilient_rec_rev_qtd_2w_prior) cq_product_resilient_rec_rev_qtd_2w_prior,
        SUM(cq_ebr_usd_rec_rev_qtd_2w_prior) cq_ebr_usd_rec_rev_qtd_2w_prior,
        SUM(cq_capi_ebr_revenue_qtd_2w_prior) cq_capi_ebr_revenue_qtd_2w_prior,
        SUM(l14d_product_resilient_rec_rev_prior) l14d_product_resilient_rec_rev_prior,
        SUM(l14d_ebr_usd_rec_rev_prior) l14d_ebr_usd_rec_rev_prior,
        SUM(l14d_capi_ebr_revenue_prior) l14d_capi_ebr_revenue_prior,
        SUM(l14d_avg_product_resilient_rec_rev_prior) l14d_avg_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ebr_usd_rec_rev_prior) l14d_avg_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_capi_ebr_revenue_prior) l14d_avg_capi_ebr_revenue_prior,
        SUM(l14d_avg_ly_product_resilient_rec_rev_prior) l14d_avg_ly_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ly_ebr_usd_rec_rev_prior) l14d_avg_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_ly_capi_ebr_revenue_prior) l14d_avg_ly_capi_ebr_revenue_prior,
        SUM(l14d_ly_product_resilient_rec_rev_prior) l14d_ly_product_resilient_rec_rev_prior,
        SUM(l14d_ly_ebr_usd_rec_rev_prior) l14d_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_ly_capi_ebr_revenue_prior) l14d_ly_capi_ebr_revenue_prior,
        SUM(L14d_revenue) l14d_revenue,
        SUM(L14d_revenue_prior) l14d_revenue_prior,
        SUM(L14d_avg_revenue) l14d_avg_revenue,
        program_agency revenue_segment,
        'Agency No Overlap' route_to_market
from

bpo_gms_quota_and_forecast_fast

where ap_username is not null or
 pm_username is not null and
 cp_username is null and
 rp_username is null and
 am_username is null


group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24, revenue_segment

    """,
)

bpo_gms_quota_and_forecast_rtm_reseller_no_overlap = PrestoInsertOperatorWithSchema(
    dep_list=[bpo_gms_quota_and_forecast_rtm_agency_no_overlap],
    table="<TABLE:bpo_gms_quota_and_forecast_rtm_fast>",
    partition="ds=<DATEID>/route_to_market=Reseller No Overlap",
    documentation={
        "description": """Creates a Subpartition for Reseller No Overlap on Route to Market"""
    },
    create=Table(
        cols=[
            Column('ultimate_client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('ultimate_client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('program', 'VARCHAR','', HiveAnon.NONE),
            Column('vertical', 'VARCHAR','', HiveAnon.NONE),
            Column('segmentation', 'VARCHAR','', HiveAnon.NONE),
            Column('asofdate', 'VARCHAR','', HiveAnon.NONE),
            Column('quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('next_quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('days_left_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_left_in_quarter_prior', 'BIGINT','', HiveAnon.NONE),
            Column('days_total_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_closed_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('l12_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l4_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l2_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_subregion', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_region', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_market', 'VARCHAR','', HiveAnon.NONE),
            Column('country', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('run_rate_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('quota', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('employee_type_1', 'VARCHAR','', HiveAnon.NONE),
            Column('employee_type_2', 'VARCHAR','', HiveAnon.NONE),
            Column('l12_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('revenue_segment', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_product_resilient_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_ebr_usd_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_capi_ebr_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
        ],
        partitions=[
            Column('ds', 'VARCHAR', 'datestamp'),
            Column('route_to_market', 'VARCHAR', ''),
        ],
        retention=15,
    ),
    select=r"""
        Select
        reseller_fbid ultimate_client_fbid ,
        reseller_name ultimate_client_name ,
        reseller_name client_name ,
        reseller_fbid client_fbid ,
        'Reseller' program,
        'Not Available' vertical ,
        'Not Available' segmentation ,
        asofdate ,
        quarter_id ,
        next_quarter_id ,
        days_left_in_quarter ,
        days_left_in_quarter_prior ,
        days_total_in_quarter ,
        days_closed_in_quarter ,
        l12_reseller_territory l12_territory ,
        l10_reseller_territory l10_territory ,
        l8_reseller_territory l8_territory  ,
        l6_reseller_territory l6_territory  ,
        l4_reseller_territory l4_territory  ,
        l2_reseller_territory l2_territory  ,
        'Not Available' fb_subregion ,
        'Not Available' fb_region ,
        'Not Available' fb_market ,
        'Not Available' country ,
        NULL employee_type_1,
        NULL employee_type_2,
        NULL l12_territory_mgr,
        NULL l10_territory_mgr,
        NULL l8_territory_mgr,
        NULL l6_territory_mgr,
        SUM(run_rate_forecast) run_rate_forecast,
        SUM(run_rate_forecast_prior) run_rate_forecast_prior,
        SUM(reseller_quota) quota,
        null sales_forecast,
        null sales_forecast_prior,
        SUM(cq_revenue) cq_revenue,
        SUM(pq_revenue) pq_revenue,
        SUM(cq_revenue_qtd_prior) cq_revenue_qtd_prior,
        SUM(lyq_revenue) lyq_revenue,
        SUM(l2yq_revenue) l2yq_revenue,
        SUM(lyq_revenue_qtd) lyq_revenue_qtd,
        SUM(l2yq_revenue_qtd) l2yq_revenue_qtd,
        SUM(lyq_revenue_qtd_prior) lyq_revenue_qtd_prior,
        SUM(l2yq_revenue_qtd_prior) l2yq_revenue_qtd_prior,
        SUM(pq_revenue_qtd) pq_revenue_qtd,
        SUM(l7d_revenue) l7d_revenue,
        SUM(l7d_revenue_prior) l7d_revenue_prior,
        SUM(l7d_avg_revenue) l7d_avg_revenue,
        SUM(l7d_avg_revenue_prior) l7d_avg_revenue_prior,
        SUM(l7d_avg_ly_revenue) l7d_avg_ly_revenue,
        SUM(l7d_avg_ly_revenue_prior) l7d_avg_ly_revenue_prior,
        SUM(l7d_ly_revenue) l7d_ly_revenue,
        SUM(l7d_ly_revenue_prior) l7d_ly_revenue_prior,
        SUM(run_rate_forecast_2w_prior) run_rate_forecast_2w_prior,
        SUM(cq_revenue_qtd_2w_prior) cq_revenue_qtd_2w_prior,
        SUM(lyq_revenue_qtd_2w_prior) lyq_revenue_qtd_2w_prior,
        SUM(l2yq_revenue_qtd_2w_prior) l2yq_revenue_qtd_2w_prior,
        SUM(l14d_avg_revenue_prior) l14d_avg_revenue_prior,
        SUM(cq_optimal_qtd_2w_prior) cq_optimal_qtd_2w_prior,
        SUM(lyq_optimal_qtd_2w_prior) lyq_optimal_qtd_2w_prior,
        SUM(l14d_optimal_prior) l14d_optimal_prior,
        SUM(l14d_avg_optimal_prior) l14d_avg_optimal_prior,
        SUM(l14d_avg_ly_optimal_prior) l14d_avg_ly_optimal_prior,
        SUM(l14d_ly_optimal_prior) l14d_ly_optimal_prior,
        SUM(cq_dr_resilient_qtd_2w_prior) cq_dr_resilient_qtd_2w_prior,
        SUM(lyq_dr_resilient_qtd_2w_prior) lyq_dr_resilient_qtd_2w_prior,
        SUM(l14d_dr_resilient_prior) l14d_dr_resilient_prior,
        SUM(l14d_avg_dr_resilient_prior) l14d_avg_dr_resilient_prior,
        SUM(l14d_avg_ly_dr_resilient_prior) l14d_avg_ly_dr_resilient_prior,
        SUM(l14d_ly_dr_resilient_prior) l14d_ly_dr_resilient_prior,
        SUM(cq_product_resilient_rec_rev_qtd_2w_prior) cq_product_resilient_rec_rev_qtd_2w_prior,
        SUM(cq_ebr_usd_rec_rev_qtd_2w_prior) cq_ebr_usd_rec_rev_qtd_2w_prior,
        SUM(cq_capi_ebr_revenue_qtd_2w_prior) cq_capi_ebr_revenue_qtd_2w_prior,
        SUM(l14d_product_resilient_rec_rev_prior) l14d_product_resilient_rec_rev_prior,
        SUM(l14d_ebr_usd_rec_rev_prior) l14d_ebr_usd_rec_rev_prior,
        SUM(l14d_capi_ebr_revenue_prior) l14d_capi_ebr_revenue_prior,
        SUM(l14d_avg_product_resilient_rec_rev_prior) l14d_avg_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ebr_usd_rec_rev_prior) l14d_avg_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_capi_ebr_revenue_prior) l14d_avg_capi_ebr_revenue_prior,
        SUM(l14d_avg_ly_product_resilient_rec_rev_prior) l14d_avg_ly_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ly_ebr_usd_rec_rev_prior) l14d_avg_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_ly_capi_ebr_revenue_prior) l14d_avg_ly_capi_ebr_revenue_prior,
        SUM(l14d_ly_product_resilient_rec_rev_prior) l14d_ly_product_resilient_rec_rev_prior,
        SUM(l14d_ly_ebr_usd_rec_rev_prior) l14d_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_ly_capi_ebr_revenue_prior) l14d_ly_capi_ebr_revenue_prior,
        SUM(L14d_revenue) l14d_revenue,
        SUM(L14d_revenue_prior) l14d_revenue_prior,
        SUM(L14d_avg_revenue) l14d_avg_revenue,
        revenue_segment,
        'Reseller No Overlap' route_to_market
from

bpo_gms_quota_and_forecast_fast

where
rp_username is not null and
ap_username is null and
pm_username is null and
am_username is null and
cp_username is null and
l2_reseller_territory = 'Reseller'

group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24, revenue_segment

    """,
)

bpo_gms_quota_and_forecast_rtm_reseller_overlap_advertiser_view = PrestoInsertOperatorWithSchema(
    dep_list=[bpo_gms_quota_and_forecast_rtm_reseller_no_overlap],
    table="<TABLE:bpo_gms_quota_and_forecast_rtm_fast>",
    partition="ds=<DATEID>/route_to_market=Reseller Overlap - Advertiser View",
    documentation={
        "description": """Creates a Subpartition for Reseller Overlap - Advertiser View on Route to Market"""
    },
    create=Table(
        cols=[
            Column('ultimate_client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('ultimate_client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('program', 'VARCHAR','', HiveAnon.NONE),
            Column('vertical', 'VARCHAR','', HiveAnon.NONE),
            Column('segmentation', 'VARCHAR','', HiveAnon.NONE),
            Column('asofdate', 'VARCHAR','', HiveAnon.NONE),
            Column('quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('next_quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('days_left_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_left_in_quarter_prior', 'BIGINT','', HiveAnon.NONE),
            Column('days_total_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_closed_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('l12_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l4_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l2_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_subregion', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_region', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_market', 'VARCHAR','', HiveAnon.NONE),
            Column('country', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('run_rate_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('quota', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('employee_type_1', 'VARCHAR','', HiveAnon.NONE),
            Column('employee_type_2', 'VARCHAR','', HiveAnon.NONE),
            Column('l12_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('revenue_segment', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_product_resilient_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_ebr_usd_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_capi_ebr_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
        ],
        partitions=[
            Column('ds', 'VARCHAR', 'datestamp'),
            Column('route_to_market', 'VARCHAR', ''),
        ],
        retention=15,
    ),
    select=r"""
        Select
        ultimate_parent_fbid ultimate_client_fbid ,
        ultimate_parent_name ultimate_client_name ,
        advertiser_name client_name ,
        advertiser_fbid client_fbid ,
        program ,
        advertiser_vertical vertical ,
        segmentation ,
        asofdate ,
        quarter_id ,
        next_quarter_id ,
        days_left_in_quarter ,
        days_left_in_quarter_prior ,
        days_total_in_quarter ,
        days_closed_in_quarter ,
        l12_reporting_territory l12_territory ,
        l10_reporting_territory l10_territory ,
        l8_reporting_territory l8_territory  ,
        l6_reporting_territory l6_territory  ,
        l4_reporting_territory l4_territory  ,
        l2_reporting_territory l2_territory  ,
        sales_adv_subregion fb_subregion ,
        sales_adv_region fb_region ,
        market fb_market ,
        advertiser_country country ,
        NULL employee_type_1,
        NULL employee_type_2,
        NULL l12_territory_mgr,
        NULL l10_territory_mgr,
        NULL l8_territory_mgr,
        NULL l6_territory_mgr,
        SUM(run_rate_forecast) run_rate_forecast,
        SUM(run_rate_forecast_prior) run_rate_forecast_prior,
        SUM(advertiser_quota) quota,
        SUM(sales_forecast) sales_forecast,
        SUM(sales_forecast_prior) sales_forecast_prior,
        SUM(cq_revenue) cq_revenue,
        SUM(pq_revenue) pq_revenue,
        SUM(cq_revenue_qtd_prior) cq_revenue_qtd_prior,
        SUM(lyq_revenue) lyq_revenue,
        SUM(l2yq_revenue) l2yq_revenue,
        SUM(lyq_revenue_qtd) lyq_revenue_qtd,
        SUM(l2yq_revenue_qtd) l2yq_revenue_qtd,
        SUM(lyq_revenue_qtd_prior) lyq_revenue_qtd_prior,
        SUM(l2yq_revenue_qtd_prior) l2yq_revenue_qtd_prior,
        SUM(pq_revenue_qtd) pq_revenue_qtd,
        SUM(l7d_revenue) l7d_revenue,
        SUM(l7d_revenue_prior) l7d_revenue_prior,
        SUM(l7d_avg_revenue) l7d_avg_revenue,
        SUM(l7d_avg_revenue_prior) l7d_avg_revenue_prior,
        SUM(l7d_avg_ly_revenue) l7d_avg_ly_revenue,
        SUM(l7d_avg_ly_revenue_prior) l7d_avg_ly_revenue_prior,
        SUM(l7d_ly_revenue) l7d_ly_revenue,
        SUM(l7d_ly_revenue_prior) l7d_ly_revenue_prior,
        SUM(run_rate_forecast_2w_prior) run_rate_forecast_2w_prior,
        SUM(cq_revenue_qtd_2w_prior) cq_revenue_qtd_2w_prior,
        SUM(lyq_revenue_qtd_2w_prior) lyq_revenue_qtd_2w_prior,
        SUM(l2yq_revenue_qtd_2w_prior) l2yq_revenue_qtd_2w_prior,
        SUM(l14d_avg_revenue_prior) l14d_avg_revenue_prior,
        SUM(cq_optimal_qtd_2w_prior) cq_optimal_qtd_2w_prior,
        SUM(lyq_optimal_qtd_2w_prior) lyq_optimal_qtd_2w_prior,
        SUM(l14d_optimal_prior) l14d_optimal_prior,
        SUM(l14d_avg_optimal_prior) l14d_avg_optimal_prior,
        SUM(l14d_avg_ly_optimal_prior) l14d_avg_ly_optimal_prior,
        SUM(l14d_ly_optimal_prior) l14d_ly_optimal_prior,
        SUM(cq_dr_resilient_qtd_2w_prior) cq_dr_resilient_qtd_2w_prior,
        SUM(lyq_dr_resilient_qtd_2w_prior) lyq_dr_resilient_qtd_2w_prior,
        SUM(l14d_dr_resilient_prior) l14d_dr_resilient_prior,
        SUM(l14d_avg_dr_resilient_prior) l14d_avg_dr_resilient_prior,
        SUM(l14d_avg_ly_dr_resilient_prior) l14d_avg_ly_dr_resilient_prior,
        SUM(l14d_ly_dr_resilient_prior) l14d_ly_dr_resilient_prior,
        SUM(cq_product_resilient_rec_rev_qtd_2w_prior) cq_product_resilient_rec_rev_qtd_2w_prior,
        SUM(cq_ebr_usd_rec_rev_qtd_2w_prior) cq_ebr_usd_rec_rev_qtd_2w_prior,
        SUM(cq_capi_ebr_revenue_qtd_2w_prior) cq_capi_ebr_revenue_qtd_2w_prior,
        SUM(l14d_product_resilient_rec_rev_prior) l14d_product_resilient_rec_rev_prior,
        SUM(l14d_ebr_usd_rec_rev_prior) l14d_ebr_usd_rec_rev_prior,
        SUM(l14d_capi_ebr_revenue_prior) l14d_capi_ebr_revenue_prior,
        SUM(l14d_avg_product_resilient_rec_rev_prior) l14d_avg_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ebr_usd_rec_rev_prior) l14d_avg_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_capi_ebr_revenue_prior) l14d_avg_capi_ebr_revenue_prior,
        SUM(l14d_avg_ly_product_resilient_rec_rev_prior) l14d_avg_ly_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ly_ebr_usd_rec_rev_prior) l14d_avg_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_ly_capi_ebr_revenue_prior) l14d_avg_ly_capi_ebr_revenue_prior,
        SUM(l14d_ly_product_resilient_rec_rev_prior) l14d_ly_product_resilient_rec_rev_prior,
        SUM(l14d_ly_ebr_usd_rec_rev_prior) l14d_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_ly_capi_ebr_revenue_prior) l14d_ly_capi_ebr_revenue_prior,
        SUM(L14d_revenue) l14d_revenue,
        SUM(L14d_revenue_prior) l14d_revenue_prior,
        SUM(L14d_avg_revenue) l14d_avg_revenue,
        revenue_segment,
        'Reseller Overlap - Advertiser View' route_to_market
from

bpo_gms_quota_and_forecast_fast

where
(rp_username is not null and cp_username is not null) or
(rp_username is not null and ap_username is not null) or
(rp_username is not null and pm_username is not null) or
(rp_username is not null and am_username is not null) and
l2_reseller_territory = 'Reseller'

group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24, revenue_segment

    """,
)


bpo_gms_quota_and_forecast_rtm_reseller_reseller_overlap_agency_view = PrestoInsertOperatorWithSchema(
    dep_list=[bpo_gms_quota_and_forecast_rtm_reseller_no_overlap],
    table="<TABLE:bpo_gms_quota_and_forecast_rtm_fast>",
    partition="ds=<DATEID>/route_to_market=Agency Overlap - Advertiser View",
    documentation={
        "description": """Creates a Subpartition for Agency Overlap - Advertiser View on Route to Market"""
    },
    create=Table(
        cols=[
            Column('ultimate_client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('ultimate_client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_name', 'VARCHAR','', HiveAnon.NONE),
            Column('client_fbid', 'VARCHAR','', HiveAnon.NONE),
            Column('program', 'VARCHAR','', HiveAnon.NONE),
            Column('vertical', 'VARCHAR','', HiveAnon.NONE),
            Column('segmentation', 'VARCHAR','', HiveAnon.NONE),
            Column('asofdate', 'VARCHAR','', HiveAnon.NONE),
            Column('quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('next_quarter_id', 'VARCHAR','', HiveAnon.NONE),
            Column('days_left_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_left_in_quarter_prior', 'BIGINT','', HiveAnon.NONE),
            Column('days_total_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('days_closed_in_quarter', 'BIGINT','', HiveAnon.NONE),
            Column('l12_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l4_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('l2_territory', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_subregion', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_region', 'VARCHAR','', HiveAnon.NONE),
            Column('fb_market', 'VARCHAR','', HiveAnon.NONE),
            Column('country', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('run_rate_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('quota', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast', 'DOUBLE','', HiveAnon.NONE),
            Column('sales_forecast_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('pq_revenue_qtd', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_avg_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l7d_ly_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('employee_type_1', 'VARCHAR','', HiveAnon.NONE),
            Column('employee_type_2', 'VARCHAR','', HiveAnon.NONE),
            Column('l12_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l10_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l8_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('l6_territory_mgr', 'VARCHAR','', HiveAnon.NONE),
            Column('revenue_segment', 'VARCHAR','', HiveAnon.NONE),
            Column('run_rate_forecast_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l2yq_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_optimal_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_optimal_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('lyq_dr_resilient_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_dr_resilient_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_product_resilient_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_ebr_usd_rec_rev_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('cq_capi_ebr_revenue_qtd_2w_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_product_resilient_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_ebr_usd_rec_rev_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_ly_capi_ebr_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_revenue_prior', 'DOUBLE','', HiveAnon.NONE),
            Column('l14d_avg_revenue', 'DOUBLE','', HiveAnon.NONE),
        ],
        partitions=[
            Column('ds', 'VARCHAR', 'datestamp'),
            Column('route_to_market', 'VARCHAR', ''),
        ],
        retention=15,
    ),
    select=r"""
        Select
        ultimate_parent_fbid ultimate_client_fbid ,
        ultimate_parent_name ultimate_client_name ,
        advertiser_name client_name ,
        advertiser_fbid client_fbid ,
        program ,
        advertiser_vertical vertical ,
        segmentation ,
        asofdate ,
        quarter_id ,
        next_quarter_id ,
        days_left_in_quarter ,
        days_left_in_quarter_prior ,
        days_total_in_quarter ,
        days_closed_in_quarter ,
        l12_reporting_territory l12_territory ,
        l10_reporting_territory l10_territory ,
        l8_reporting_territory l8_territory  ,
        l6_reporting_territory l6_territory  ,
        l4_reporting_territory l4_territory  ,
        l2_reporting_territory l2_territory  ,
        sales_adv_subregion fb_subregion ,
        sales_adv_region fb_region ,
        market fb_market ,
        advertiser_country country ,
        NULL employee_type_1,
        NULL employee_type_2,
        NULL l12_territory_mgr,
        NULL l10_territory_mgr,
        NULL l8_territory_mgr,
        NULL l6_territory_mgr,
        SUM(run_rate_forecast) run_rate_forecast,
        SUM(run_rate_forecast_prior) run_rate_forecast_prior,
        SUM(advertiser_quota) quota,
        SUM(sales_forecast) sales_forecast,
        SUM(sales_forecast_prior) sales_forecast_prior,
        SUM(cq_revenue) cq_revenue,
        SUM(pq_revenue) pq_revenue,
        SUM(cq_revenue_qtd_prior) cq_revenue_qtd_prior,
        SUM(lyq_revenue) lyq_revenue,
        SUM(l2yq_revenue) l2yq_revenue,
        SUM(lyq_revenue_qtd) lyq_revenue_qtd,
        SUM(l2yq_revenue_qtd) l2yq_revenue_qtd,
        SUM(lyq_revenue_qtd_prior) lyq_revenue_qtd_prior,
        SUM(l2yq_revenue_qtd_prior) l2yq_revenue_qtd_prior,
        SUM(pq_revenue_qtd) pq_revenue_qtd,
        SUM(l7d_revenue) l7d_revenue,
        SUM(l7d_revenue_prior) l7d_revenue_prior,
        SUM(l7d_avg_revenue) l7d_avg_revenue,
        SUM(l7d_avg_revenue_prior) l7d_avg_revenue_prior,
        SUM(l7d_avg_ly_revenue) l7d_avg_ly_revenue,
        SUM(l7d_avg_ly_revenue_prior) l7d_avg_ly_revenue_prior,
        SUM(l7d_ly_revenue) l7d_ly_revenue,
        SUM(l7d_ly_revenue_prior) l7d_ly_revenue_prior,
        SUM(run_rate_forecast_2w_prior) run_rate_forecast_2w_prior,
        SUM(cq_revenue_qtd_2w_prior) cq_revenue_qtd_2w_prior,
        SUM(lyq_revenue_qtd_2w_prior) lyq_revenue_qtd_2w_prior,
        SUM(l2yq_revenue_qtd_2w_prior) l2yq_revenue_qtd_2w_prior,
        SUM(l14d_avg_revenue_prior) l14d_avg_revenue_prior,
        SUM(cq_optimal_qtd_2w_prior) cq_optimal_qtd_2w_prior,
        SUM(lyq_optimal_qtd_2w_prior) lyq_optimal_qtd_2w_prior,
        SUM(l14d_optimal_prior) l14d_optimal_prior,
        SUM(l14d_avg_optimal_prior) l14d_avg_optimal_prior,
        SUM(l14d_avg_ly_optimal_prior) l14d_avg_ly_optimal_prior,
        SUM(l14d_ly_optimal_prior) l14d_ly_optimal_prior,
        SUM(cq_dr_resilient_qtd_2w_prior) cq_dr_resilient_qtd_2w_prior,
        SUM(lyq_dr_resilient_qtd_2w_prior) lyq_dr_resilient_qtd_2w_prior,
        SUM(l14d_dr_resilient_prior) l14d_dr_resilient_prior,
        SUM(l14d_avg_dr_resilient_prior) l14d_avg_dr_resilient_prior,
        SUM(l14d_avg_ly_dr_resilient_prior) l14d_avg_ly_dr_resilient_prior,
        SUM(l14d_ly_dr_resilient_prior) l14d_ly_dr_resilient_prior,
        SUM(cq_product_resilient_rec_rev_qtd_2w_prior) cq_product_resilient_rec_rev_qtd_2w_prior,
        SUM(cq_ebr_usd_rec_rev_qtd_2w_prior) cq_ebr_usd_rec_rev_qtd_2w_prior,
        SUM(cq_capi_ebr_revenue_qtd_2w_prior) cq_capi_ebr_revenue_qtd_2w_prior,
        SUM(l14d_product_resilient_rec_rev_prior) l14d_product_resilient_rec_rev_prior,
        SUM(l14d_ebr_usd_rec_rev_prior) l14d_ebr_usd_rec_rev_prior,
        SUM(l14d_capi_ebr_revenue_prior) l14d_capi_ebr_revenue_prior,
        SUM(l14d_avg_product_resilient_rec_rev_prior) l14d_avg_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ebr_usd_rec_rev_prior) l14d_avg_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_capi_ebr_revenue_prior) l14d_avg_capi_ebr_revenue_prior,
        SUM(l14d_avg_ly_product_resilient_rec_rev_prior) l14d_avg_ly_product_resilient_rec_rev_prior,
        SUM(l14d_avg_ly_ebr_usd_rec_rev_prior) l14d_avg_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_avg_ly_capi_ebr_revenue_prior) l14d_avg_ly_capi_ebr_revenue_prior,
        SUM(l14d_ly_product_resilient_rec_rev_prior) l14d_ly_product_resilient_rec_rev_prior,
        SUM(l14d_ly_ebr_usd_rec_rev_prior) l14d_ly_ebr_usd_rec_rev_prior,
        SUM(l14d_ly_capi_ebr_revenue_prior) l14d_ly_capi_ebr_revenue_prior,
        SUM(L14d_revenue) l14d_revenue,
        SUM(L14d_revenue_prior) l14d_revenue_prior,
        SUM(L14d_avg_revenue) l14d_avg_revenue,
        revenue_segment,
        'Reseller Overlap - Advertiser View' route_to_market
from

bpo_gms_quota_and_forecast_fast

where
(rp_username is not null and cp_username is not null) or
(rp_username is not null and ap_username is not null) or
(rp_username is not null and pm_username is not null) or
(rp_username is not null and am_username is not null) and
l2_reseller_territory = 'Reseller'

group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24, revenue_segment

    """,
)

delete_bpo_gms_quota_and_forecast_rtm_fast = PrestoOperator(
    dep_list=[
        bpo_gms_quota_and_forecast_rtm_agency,
        bpo_gms_quota_and_forecast_rtm_advertiser,
        bpo_gms_quota_and_forecast_rtm_reseller,
        bpo_gms_quota_and_forecast_rtm_reporting,
        bpo_gms_quota_and_forecast_rtm_overlap,
        bpo_gms_quota_and_forecast_rtm_ap_rp_overlap,
        bpo_gms_quota_and_forecast_rtm_pm_rp_overlap,
        bpo_gms_quota_and_forecast_rtm_cp_am_overlap,
        bpo_gms_quota_and_forecast_rtm_cp_ap_overlap,
        bpo_gms_quota_and_forecast_rtm_cp_pm_overlap,
        bpo_gms_quota_and_forecast_rtm_cp_rp_overlap,
        bpo_gms_quota_and_forecast_rtm_am_ap_overlap,
        bpo_gms_quota_and_forecast_rtm_am_pm_overlap,
        bpo_gms_quota_and_forecast_rtm_am_rp_overlap,
        bpo_gms_quota_and_forecast_rtm_agency_overlap,
        bpo_gms_quota_and_forecast_rtm_reseller_overlap,
        bpo_gms_quota_and_forecast_rtm_ap_pm_overlap,
        bpo_gms_quota_and_forecast_rtm_agency_no_overlap,
        bpo_gms_quota_and_forecast_rtm_reseller_no_overlap,
        bpo_gms_quota_and_forecast_rtm_reseller_overlap_advertiser_view,
        bpo_gms_quota_and_forecast_rtm_reseller_reseller_overlap_agency_view,
    ],
    query=r"""
DELETE FROM <TABLE:bpo_gms_quota_and_forecast_rtm_fast>
where ds <> '<DATEID>'
""",
)

if is_test():
    pass
else:

    tableau_refresh_bpo_gms_quota_and_forecast_rtm_fast = TableauPublishOperator(
        dep_list=[
            delete_bpo_gms_quota_and_forecast_rtm_fast,
        ],
        refresh_cfg_id=28681,
        num_retries=2,
    )
